var surveyJSON = '{"title": "Create OWRS files",' +
'"utilities": [' +
'"Irvine Ranch Water District",'+
'"Eastern Municipal Water District",'+
'"Santa Margarita Water District",'+
'"Western Municipal Water District of Riverside",'+
'"Monte Vista Water District",'+
'"Santa Rosa  City of",'+
'"Las Virgenes Municipal Water District",'+
'"Sacramento  City of",'+
'"Los Angeles Department of Water and Power",'+
'"East Bay Municipal Utilities District",'+
'"San Diego  City of",'+
'"San Jose Water Company",'+
'"San Francisco Public Utilities Commission",'+
'"Fresno  City of",'+
'"Long Beach  City of",'+
'"Anaheim  City of",'+
'"Alameda County Water District",'+
'"Riverside  City of",'+
'"Santa Ana  City of",'+
'"Coachella Valley Water District",'+
'"California Water Service Company Bakersfield",'+
'"San Gabriel Valley Water Company",'+
'"Helix Water District",'+
'"Golden State Water Company Southwest",'+
'"Modesto, City of",'+
'"Otay Water District",'+
'"San Gabriel Valley Fontana Water Company",'+
'"Los Angeles County Public Works Waterworks District 40",'+
'"Oxnard  City of",'+
'"Cucamonga Valley Water District",'+
'"California-American Water Company Sacramento District",'+
'"Contra Costa Water District",'+
'"San Bernardino  City of",'+
'"Huntington Beach  City of",'+
'"Glendale  City of",'+
'"Sweetwater Authority",'+
'"Marin Municipal Water District",'+
'"Corona  City of",'+
'"Suburban Water Systems San Jose Hills",'+
'"Stockton  City of",'+
'"Sacramento County Water Agency",'+
'"Garden Grove  City of",'+
'"Sacramento Suburban Water District",'+
'"Oceanside  City of",'+
'"California Water Service Company Stockton",'+
'"Moulton Niguel Water District",'+
'"Ontario  City of",'+
'"Pasadena  City of",'+
'"Rancho California Water District",'+
'"California Water Service Company East Los Angeles",'+
'"Hayward  City of",'+
'"Pomona  City of",'+
'"Elsinore Valley Municipal Water District",'+
'"Sunnyvale  City of",'+
'"Escondido  City of",'+
'"Bakersfield  City of",'+
'"California Water Service Company Dominguez",'+
'"California Water Service Company Visalia",'+
'"Orange  City of",'+
'"Fullerton  City of",'+
'"California Water Service Company Mid Peninsula",'+
'"Park Water Company",'+
'"Roseville  City of",'+
'"El Dorado Irrigation District",'+
'"Vista Irrigation District",'+
'"Victorville Water District",'+
'"Vallejo  City of",'+
'"Castaic Lake Water Agency Santa Clarita Water Division",'+
'"California Water Service Company Salinas District",'+
'"Santa Clara  City of",'+
'"Valencia Water Company",'+
'"Jurupa Community Service District",'+
'"San Jose  City of",'+
'"Palmdale Water District",'+
'"Inglewood  City of",'+
'"Suburban Water Systems Whittier/La Mirada",'+
'"San Buenaventura  City of",'+
'"Walnut Valley Water District",'+
'"Downey  City of",'+
'"Clovis  City of",'+
'"Golden State Water Company West Orange",'+
'"Mesa Water District",'+
'"Azusa  City of",'+
'"Daly City  City of",'+
'"Fairfield  City of",'+
'"Antioch  City of",'+
'"Burbank  City of",'+
'"Torrance  City of",'+
'"Desert Water Agency",'+
'"East Valley Water District",'+
'"California Water Service Company Chico District",'+
'"California-American Water Company Los Angeles District",'+
'"South Gate  City of",'+
'"Santa Maria  City of",'+
'"California-American Water Company Monterey District",'+
'"Great Oaks Water Company Incorporated",'+
'"Placer County Water Agency",'+
'"Vallecitos Water District",'+
'"California Water Service Company Hermosa/Redondo",'+
'"California-American Water Company San Diego District",'+
'"Santa Cruz  City of",'+
'"Westminster  City of",'+
'"Santa Monica  City of",'+
'"Santa Barbara  City of",'+
'"Hesperia Water District City of",'+
'"Redding  City of",'+
'"Ventura County Waterworks District No. 8",'+
'"Vacaville  City of",'+
'"Padre Dam Municipal Water District",'+
'"Indio  City of",'+
'"Redwood City  City of",'+
'"Goleta Water District",'+
'"Napa  City of",'+
'"Carlsbad Municipal Water District",'+
'"Tracy  City of",'+
'"Redlands  City of",'+
'"Alhambra  City of",'+
'"Olivenhain Municipal Water District",'+
'"Merced  City of",'+
'"Buena Park  City of",'+
'"Compton  City of",'+
'"Dublin San Ramon Services District",'+
'"Yorba Linda Water District",'+
'"Chino  City of",'+
'"Chino Hills  City of",'+
'"Mountain View  City of",'+
'"Upland  City of",'+
'"Manteca  City of",'+
'"Pleasanton  City of",'+
'"West Valley Water District",'+
'"California Water Service Company Bear Gulch",'+
'"Lynwood  City of",'+
'"Turlock  City of",'+
'"Valley County Water District",'+
'"Milpitas  City of",'+
'"California Water Service Company Los Altos/Suburban",'+
'"California Water Service Company Palos Verdes",'+
'"Yuba City  City of",'+
'"Davis  City of",'+
'"Tustin  City of",'+
'"Citrus Heights Water District",'+
'"Folsom  City of",'+
'"Newport Beach  City of",'+
'"Pittsburg  City of",'+
'"Watsonville  City of",'+
'"Golden State Water Company Florence Graham",'+
'"Madera  City of",'+
'"Whittier  City of",'+
'"Palo Alto  City of",'+
'"Huntington Park  City of",'+
'"Lodi  City of Public Works Department",'+
'"La Habra  City of Public Works",'+
'"Apple Valley Ranchos Water Company",'+
'"Tulare, City of",'+
'"Monterey Park  City of",'+
'"California-American Water Ventura District",'+
'"Rowland Water District",'+
'"North Marin Water District",'+
'"Petaluma  City of",'+
'"Porterville  City of",'+
'"California Water Service Company South San Francisco",'+
'"Hanford  City of",'+
'"Fountain Valley  City of",'+
'"Lakewood  City of",'+
'"California Water Service Company Livermore",'+
'"Brentwood  City of",'+
'"Paramount  City of",'+
'"Golden State Water Company Bell-Bell Gardens",'+
'"Arcadia  City of",'+
'"Woodland  City of",'+
'"Delano  City of",'+
'"San Clemente  City of",'+
'"Gilroy  City of",'+
'"Golden State Water Company San Dimas",'+
'"Rialto  City of",'+
'"Colton, City of",'+
'"Lake Hemet Municipal Water District",'+
'"Poway  City of",'+
'"Thousand Oaks  City of",'+
'"Glendora  City of",'+
'"Beverly Hills  City of",'+
'"West Sacramento  City of",'+
'"Cerritos  City of",'+
'"Calaveras County Water District",'+
'"El Toro Water District",'+
'"Golden State Water Company Artesia",'+
'"Ceres  City of",'+
'"Camarillo  City of",'+
'"Golden State Water Company Placentia",'+
'"Bellflower-Somerset Mutual Water Company",'+
'"Lincoln  City of",'+
'"San Luis Obispo  City of",'+
'"Coachella  City of",'+
'"Newhall County Water District",'+
'"San Gabriel County Water District",'+
'"Yucaipa Valley Water District",'+
'"El Centro  City of",'+
'"Nevada Irrigation District",'+
'"Hawthorne  City of",'+
'"Elk Grove Water Service",'+
'"Golden State Water Company Norwalk",'+
'"San Bruno  City of",'+
'"Golden State Water Company Cordova",'+
'"Morgan Hill  City of",'+
'"Rohnert Park  City of",'+
'"Golden State Water Company Simi Valley",'+
'"Brea  City of",'+
'"Lake Arrowhead Community Services District",'+
'"Beaumont-Cherry Valley Water District",'+
'"Lompoc  City of",'+
'"Calexico  City of",'+
'"Diablo Water District",'+
'"Soquel Creek Water District",'+
'"San Juan Capistrano  City of",'+
'"Covina  City of ",'+
'"Monrovia  City of",'+
'"Pico Rivera  City of",'+
'"North Coast County Water District",'+
'"Ventura County Waterworks District No 1",'+
'"Carmichael Water District",'+
'"Mission Springs Water District",'+
'"San Dieguito Water District",'+
'"Estero Municipal Improvement District",'+
'"Los Banos, City of",'+
'"Golden State Water Company Claremont",'+
'"San Juan Water District",'+
'"Ramona Municipal Water District",'+
'"Fair Oaks Water District",'+
'"Golden State Water Company Culver City",'+
'"Manhattan Beach  City of",'+
'"Camrosa Water District",'+
'"Lakeside Water District",'+
'"Martinez  City of",'+
'"South Coast Water District",'+
'"Fallbrook Public Utility District",'+
'"Marina Coast Water District",'+
'"Oildale Mutual Water Company",'+
'"South Tahoe Public Utilities District",'+
'"Truckee-Donner Public Utilities District",'+
'"Adelanto City of",'+
'"La Verne  City of",'+
'"Montebello Land and Water Company",'+
'"Crescenta Valley Water District",'+
'"Rubidoux Community Service District",'+
'"Livermore  City of Division of Water Resources",'+
'"Golden State Water Company Orcutt",'+
'"Atascadero Mutual Water Company",'+
'"East Niles Community Service District",'+
'"Vaughn Water Company",'+
'"Golden State Water Company Barstow",'+
'"Indian Wells Valley Water District",'+
'"Burlingame  City of",'+
'"Tuolumne Utilities District",'+
'"Sunny Slope Water Company",'+
'"Paso Robles  City of",'+
'"Banning  City of",'+
'"Santa Paula  City of",'+
'"Hemet  City of",'+
'"Rincon Del Diablo Municipal Water District",'+
'"Suisun-Solano Water Authority",'+
'"Atwater  City of",'+
'"Alco Water Service",'+
'"East Palo Alto, City of",'+
'"Windsor, Town of",'+
'"Benicia  City of",'+
'"Brawley  City of",'+
'"Golden State Water Company S San Gabriel",'+
'"Norco  City of",'+
'"Eureka  City of",'+
'"Golden State Water Company S Arcadia",'+
'"Mid-Peninsula Water District",'+
'"South Pasadena  City of",'+
'"Wasco  City of",'+
'"Paradise Irrigation District",'+
'"City of Big Bear Lake, Dept of Water & Power",'+
'"Sanger  City of",'+
'"Orchard Dale Water District",'+
'"Seal Beach  City of",'+
'"Valley Center Municipal Water District",'+
'"Lemoore  City of",'+
'"Pico Water District",'+
'"Phelan Pinon Hills Community Services District",'+
'"California Water Service Company Selma",'+
'"Hi-Desert Water District",'+
'"Dinuba  City of",'+
'"Galt  City of",'+
'"Reedley  City of",'+
'"Corcoran, City of",'+
'"Valley of the Moon Water District",'+
'"Loma Linda  City of *",'+
'"Riverbank  City of",'+
'"San Fernando  City of",'+
'"Amador Water Agency",'+
'"Hollister  City of",'+
'"El Monte  City of",'+
'"Golden State Water Company Bay Point",'+
'"Los Angeles County Public Works Waterworks District 29",'+
'"Oakdale  City of",'+
'"Port Hueneme  City of",'+
'"Millbrae  City of",'+
'"Fruitridge Vista Water Company",'+
'"West Kern Water District",'+
'"Patterson  City of",'+
'"Laguna Beach County Water District",'+
'"Arvin Community Services District",'+
'"Lomita  City of",'+
'"Lathrop, City of ",'+
'"Quartz Hill Water District",'+
'"American Canyon, City of",'+
'"Humboldt Community Service District",'+
'"Lamont Public Utility District",'+
'"Santa Fe Irrigation District",'+
'"Sunnyslope County Water District",'+
'"Rainbow Municipal Water District",'+
'"Olivehurst Public Utility District",'+
'"California Water Service Company Westlake",'+
'"Shafter  City of",'+
'"San Lorenzo Valley Water District",'+
'"Linda County Water District",'+
'"Twentynine Palms Water District",'+
'"Arcata  City of",'+
'"Bella Vista Water District",'+
'"Crescent City  City of",'+
'"Norwalk City of",'+
'"South Feather Water and Power Agency",'+
'"Santa Fe Springs  City of",'+
'"Imperial, City of",'+
'"San Jacinto  City of",'+
'"Greenfield, City of",'+
'"Rosamond Community Service District",'+
'"Tahoe City Public Utilities District",'+
'"Arroyo Grande  City of",'+
'"McKinleyville Community Service District",'+
'"Bakman Water Company",'+
'"Soledad, City of",'+
'"Mammoth Community Water District",'+
'"Pinedale County Water District",'+
'"Coastside County Water District",'+
'"El Segundo  City of",'+
'"Coalinga City of",'+
'"Orange Vale Water Company",'+
'"Lincoln Avenue Water Company",'+
'"Ukiah  City of",'+
'"Menlo Park  City of",'+
'"Mountain House Community Services District",'+
'"La Palma  City of",'+
'"Lee Lake Water District",'+
'"Riverside Highland Water Company",'+
'"Ripon  City of",'+
'"Fillmore  City of",'+
'"California Water Service Company King City",'+
'"Discovery Bay Community Services District",'+
'"Livingston  City of",'+
'"Carpinteria Valley Water District",'+
'"Kerman, City of",'+
'"California City  City of",'+
'"San Bernardino County Service Area 64",'+
'"Red Bluff  City of",'+
'"Westborough Water District",'+
'"Blythe  City of",'+
'"Montecito Water District",'+
'"Nipomo Community Services District",'+
'"Trabuco Canyon Water District",'+
'"Grover Beach  City of",'+
'"Big Bear City Community Services District",'+
'"California Water Service Company Marysville",'+
'"Triunfo Sanitation District / Oak Park Water Service",'+
'"Fortuna  City of",'+
'"Healdsburg  City of",'+
'"Kingsburg, City of",'+
'"Sonoma  City of",'+
'"San Bernardino County Service Area 70J",'+
'"California Water Service Company Oroville",'+
'"Anderson, City of",'+
'"Sierra Madre  City of",'+
'"Rio Linda - Elverta Community Water District",'+
'"Hillsborough  Town of",'+
'"City of Newman Water Department",'+
'"Morro Bay  City of",'+
'"Exeter  City of",'+
'"Scotts Valley Water District",'+
'"Shasta Lake  City of",'+
'"California Water Service Company Dixon, City of",'+
'"Casitas Municipal Water District",'+
'"Valley Water Company",'+
'"Georgetown Divide Public Utilities District",'+
'"Del Oro Water Company",'+
'"Rubio Canyon Land and Water Association",'+
'"Joshua Basin Water District",'+
'"Susanville  City of",'+
'"Myoma Dunes Mutual Water Company",'+
'"Perris, City of",'+
'"Tehachapi, City of",'+
'"Winton Water & Sanitary District",'+
'"Rio Vista, city of",'+
'"Pismo Beach  City of",'+
'"Yreka, City of",'+
'"Sweetwater Springs Water District",'+
'"Crestline Village Water District",'+
'"North Tahoe Public Utility District",'+
'"Golden State Water Company Cowan Heights",'+
'"California Water Service Company Willows",'+
'"Cambria Community Services District",'+
'"California Water Service Company Kern River Valley",'+
'"East Orange County Water District",'+
'"California Water Service Company Redwood Valley",'+
'"California Water Service Company Antelope Valley",'+
'"Groveland Community Services District",'+
'"Humboldt Bay Municipal Water District",'+
'"Vernon  City of"],'+
'"questions": ["Enter the Name of the Utility:", "Enter the Bill Frequency:",'+
'"Enter the Effective Date of this Rate Structure:", "Select the Customer Classes Used by the Utility:",'+
' "Does this Customer Class contain a Service Charge?", "Does the Service Charge depend on the following:",'+
'"Does this Customer Class contain a Commodity Charge?", "What type of Commodity Charge does this Customer Class Contain?",'+
'"Does this Uniform Commodity Charge Depend On Anything?", "Does this Tiered Commodity Charge Depend On Anything?",' +
' "", "Select the parameters to include:"],'+
'"billFrequency": ["Monthly", "BiMonthly", "Other"],'+
'"rateStructures":['+
'"RESIDENTIAL_SINGLE", "RESIDENTIAL_MULTI",'+
'"IRRIGATION", "COMMERCIAL",'+
'"INDUSTRIAL", "INSTITUTIONAL",'+
'"FIRE_SERVICE", "NONPOTABLE",'+
'"NON_RESIDENTIAL", "UNMETERED",'+
'"RECLAIMED", "GOVERNMENTAL",'+
'"INTERRUPTIBLE", "DOCKS SHIPPING",'+
'"BUILDING CONTRACTOR", "RESIDENTIAL CONSTRUCTION",'+
'"Other"],'+
'"serviceDependsOn": ["Meter Size", "Meter Type"],'+
'"commodityDependsOn": ["Season", "Temperature Zone", "Elevation Zone", "Pressure Zone", "Lot Size Group"],'+
'"meterSizes": ["5/8","3/4", "1", "1 1/2", "2", "3", "4", "6", "8", "10", "12", "14", "16", "18"],'+
'"meterTypes": ["Disc", "Compound", "Turbo", "Magnetic Meter", "Propeller", "Omni F2"],'+
'"season": ["Summer", "Winter"],'+
'"temperatureZone": ["Low", "Medium", "High"], '+
'"elevationZone":["1", "2", "3", "4", "5"],'+
'"pressureZone":["1", "2", "3", "4", "5"],'+
'"lotSizeGroup":["1", "2", "3", "4", "5"]}'
var survey = JSON.parse(surveyJSON)

                var form = document.getElementById("survey");
                var title = document.getElementById("Header");
                var subtitle = document.getElementById("lilHeader");
                var currentIndex = 0;
                
                var Question;
                var Answer;
                var text;
                
                var UtilityName = "";
                var BillFrequency = "";
                var EffectiveDate = "";
                var SelectedRateStructures = [];
                
                var serviceParameters = [];
                var meterSizes = [];
                var meterTypes = [];
                var serviceChargeCategories = [];
                var serviceCharges = [];
                var isServiceCharge = [];
                
                var uniformParameters = [];
                var commodityStructure = [];
                var numOfTiers = [];
                var tierStartsParameters = [];
                var tierStarts = [];
                var tierPricesParameters = [];
                var tierPrices = [];
                var uniformPrices = [];
                var isCommodityCharge = [];
                var isUniformDependsOn = [];
                var commodityChargeCategories = [];
                var commodityCharges = [];
                var tierStartsDependsOn = [];
                var tierPricesDependsOn = [];
                var uniformDependsOn = [];
                var season = [];
                var elevationZone = [];
                var pressureZone = [];
                var temperatureZone = [];
                var lotSizeGroup = [];
                
                
                
                function MainPage()
                {
                    
                    title.innerHTML = survey.title;
                    subtitle.innerHTML = "";
                    clear(form);
                    
                    QuestionTxt(survey.questions[0], 1, form);
                
                    Answer = document.createElement("select");
                
                    for(var i = 0; i < survey.utilities.length; ++i)
                    {
                        Answer.appendChild(new Option(survey.utilities[i], survey.utilities[i]));
                    }
                    Answer.id = "utilityName";
                    form.appendChild(Answer);
                
                    QuestionTxt(survey.questions[1], 2, form);
                
                    Answer = document.createElement("select");
                
                    for(var i = 0; i < survey.billFrequency.length; ++i)
                    {
                        Answer.appendChild(new Option(survey.billFrequency[i], survey.billFrequency[i]));
                    }
                    Answer.id = "billFrequency";
                    form.appendChild(Answer);
                    
                    QuestionTxt(survey.questions[2], 3, form);
                    
                    Answer = document.createElement("input");
                    Answer.setAttribute("type", "date");
                    Answer.id = "effectiveDate";
                    form.appendChild(Answer);
                    
                    QuestionTxt(survey.questions[3], 4, form);
                    
                    for(var i = 0; i < survey.rateStructures.length; ++i)
                    {
                        Answer = document.createElement("input");
                        Answer.setAttribute("type", "checkbox"); Answer.class = "custClass";
                        Answer.id = "custClass" + i; Answer.Value = survey.rateStructures[i];
                        form.appendChild(Answer);
                        
                        Answer = document.createElement("label");
                        Answer.setAttribute("for", "custClass" + i);
                        Answer.appendChild(document.createTextNode(survey.rateStructures[i]));
                        form.appendChild(Answer); 
                        var BREAK = document. createElement("br");
                        form.appendChild(BREAK);
                    }
                    
                    var Button = document.createElement("span");
                    Button.id = "nextButton";
                    Button.innerHTML = '<button type = "button" onclick = "GetMainPageAnswers()">Next</button>';
                    form.appendChild(Button);
                    
                    if(UtilityName != "")
                    {
                        document.getElementById("utilityName").value = UtilityName;
                        document.getElementById("billFrequency").value = BillFrequency;
                        document.getElementById("effectiveDate").value = EffectiveDate;
                        
                        for(var i = 0; i < 17; ++i)
                        {
                            var temp = document.getElementById("custClass" + i);
                            
                            check = false;
                            for(var j = 0; j < SelectedRateStructures.length; ++j)
                            {
                                var test = survey.rateStructures[i];
                                
                                if( test == SelectedRateStructures[j])
                                {
                                    var check = true;
                                }
                            }
                            
                            if(check)
                            {
                                temp.checked = true;
                            }
                        }
                    }
                    
                }
                
                function GetMainPageAnswers()
                {
                    SelectedRateStructures = [];
                    UtilityName = document.getElementById("utilityName").value;
                    BillFrequency = document.getElementById("billFrequency").value;
                    EffectiveDate = document.getElementById("effectiveDate").value;
                    
                    var date = true;
                    if(EffectiveDate == "")
                    { 
                        alert("Must select an Effective Date for the Rate Structure");
                        date = false;
                    }
                    
                    var noneChecked = true;
                    for(var numOfCheckBoxes = 0; numOfCheckBoxes < 17; ++numOfCheckBoxes)
                    {
                        var temp = document.getElementById("custClass" + numOfCheckBoxes);
                        
                        
                        if(temp.checked == true)
                        { 
                            SelectedRateStructures.push(survey.rateStructures[numOfCheckBoxes]);
                            noneChecked = false;
                        }
                    }
                    if(noneChecked)
                    { alert("Please Select A Customer Class"); }
                    
                    if(!noneChecked && date)
                    RateStructure(currentIndex);
                }
                
                
                
                
                function RateStructure(index)
                {
                    title.innerHTML = UtilityName;
                    subtitle.innerHTML = SelectedRateStructures[index];
                    clear(form);
                    
                    var serviceList = document.createElement("div");
                    serviceList.id = "serviceList";
                    form.appendChild(serviceList);
                    
                    QuestionTxt(survey.questions[4], 5, serviceList);
                    
                    Answer = document.createElement("span");
                    
                    if(isServiceCharge[currentIndex])
                    {
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No" />'+
                        '<label for = "NoServiceCharge">No</label>';
                        serviceList.appendChild(Answer);
                        getServiceChargeInfo();
                    }
                    else
                    {  
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes" />'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoServiceCharge">No</label>';
                        serviceList.appendChild(Answer);
                    }
                    
                    var BREAK = document.createElement("br");
                    serviceList.appendChild(BREAK);
                    
                    var commodityList = document.createElement("div");
                    commodityList.id = "commodityList";
                    form.appendChild(commodityList);
                    
                    QuestionTxt(survey.questions[6], 9, commodityList);
                    
                    Answer = document.createElement("span");
                    
                    if(isCommodityCharge[currentIndex])
                    {
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No" />'+
                        '<label for = "NoCommodityCharge">No</label>';
                        commodityList.appendChild(Answer);
                        getCommodityChargeInfo();
                    }
                    else
                    {  
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" />'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoCommodityCharge">No</label>';
                        commodityList.appendChild(Answer);
                    }
                    
                    var Button = document.createElement("span");
                    if(currentIndex == SelectedRateStructures.length - 1)
                    {
                        Button.innerHTML = '<button type = "button" onclick = "PreviousGetAnswers()">Previous</button>' + 
                        '<button type = "button" onclick = "NextGetAnswers()">Complete</button>';
                    }
                    else
                    {
                        Button.innerHTML = '<button type = "button" onclick = "PreviousGetAnswers()">Previous</button>' + 
                        '<button type = "button" onclick = "NextGetAnswers()">Next</button>';
                    }
                    form.appendChild(Button);
                }
                
                
                
                
                
                function getServiceChargeInfo()
                {
                    var RadioButton = document.getElementById("YesServiceCharge");
                    
                    isServiceCharge[currentIndex] = RadioButton.checked;
                    
                    if(RadioButton.checked == true)
                    {
                        QuestionTxt(survey.questions[5], 6, serviceList);
                        
                        Answer = document.createElement("span");
                        Answer.innerHTML = "";
                        
                        for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                        {
                            var checkboxID = "dependsOn" + i;
                            Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "getServiceChargeDepends()" value ="' + survey.serviceDependsOn[i]+ '"/>'+
                            '<label for = checkboxID>' + survey.serviceDependsOn[i] + '</label>';
                        }
                        
                        serviceList.appendChild(Answer);
                        
                        var serviceDependsOnDiv = document.createElement("div");
                        serviceDependsOnDiv.id = "serviceDependsOnDiv";
                        serviceList.appendChild(serviceDependsOnDiv);
                        
                        if(serviceParameters[currentIndex] != null)
                        {
                            for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                            {
                                var isChecked = document.getElementById("dependsOn" + i);
                                for(var j = 0; j < serviceParameters[currentIndex].length; ++j)
                                {
                                    if(serviceParameters[currentIndex][j] == isChecked.value)
                                    {
                                        isChecked.checked = true;
                                    }
                                }
                            }
                            
                            getServiceChargeDepends();
                        }
                    }
                    else
                    {
                        clear(serviceList);
                        serviceParameters[currentIndex] = [];
                        
                        QuestionTxt(survey.questions[4], 5, serviceList);
                        
                        Answer = document.createElement("span");
                    
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes"/>'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No" checked = "true"/>'+
                        '<label for = "NoServiceCharge">No</label>';
                    
                        serviceList.appendChild(Answer);
                    }
                }
                
                function getCommodityChargeInfo()
                {
                    var RadioButton = document.getElementById("YesCommodityCharge");
                    
                    isCommodityCharge[currentIndex] = RadioButton.checked;
                    
                    if(RadioButton.checked == true)
                    {
                        QuestionTxt(survey.questions[7], 10, commodityList);
                        
                        Answer = document.createElement("span");
                        Answer.innerHTML = '<input type = "radio" id = "Uniform" name = "CommodityStructure" onclick = "UniformDepends()" value = "Uniform"/>'+
                        '<label for = "Uniform">Uniform</label>'+
                        '<input type = "radio" id = "Tiered" name = "CommodityStructure" onclick = "TieredDepends()" value = "Tiered"/>'+
                        '<label for = "Tiered">Tiered</label>'+
                        '<input type = "radio" id = "Budget" name = "CommodityStructure" onclick = "BudgetDepends()" value = "Budget"/>'+
                        '<label for = "Uniform">Budget</label>';
                        
                        commodityList.appendChild(Answer);
                        
                        var commodityDependsOnDiv = document.createElement("div");
                        commodityDependsOnDiv.id = "commodityDependsOnDiv";
                        commodityList.appendChild(commodityDependsOnDiv);
                    }
                    else
                    {
                        clear(commodityList);
                        commodityStructure[currentIndex] = [];
                        
                        QuestionTxt(survey.questions[6], 9, serviceList);
                        
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" />'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoCommodityCharge">No</label>';
                        
                        commodityList.appendChild(Answer);
                    }
                    
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        var Radio = document.getElementById("Uniform");
                        Radio.checked = true;
                        
                        UniformDepends();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered')
                    {
                        var Radio = document.getElementById("Tiered");
                        Radio.checked = true;
                        
                        TieredDepends();
                    }
                    else if(commodityStructure[currentIndex] == 'Budget')
                    {
                        var Radio = document.getElementById("Budget");
                        Radio.checked = true;
                        
                        BudgetDepends();
                    }
                }
                
                
                
                function getServiceChargeDepends()
                {
                    serviceParameters[currentIndex] = [];
                    
                    for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                    {
                        var tempID = "dependsOn" + i + "";
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox.checked == true)
                        {
                            serviceParameters[currentIndex].push(survey.serviceDependsOn[i]);
                        }
                        else
                        {
                            if(survey.serviceDependsOn[i] == "Meter Type")
                            {
                                meterTypes[currentIndex] = null;
                            }
                            else if(survey.serviceDependsOn[i] == "Meter Size")
                            {
                                meterSizes[currentIndex] = null;
                            }
                        }
                    }
                    
                    var serviceDependsOnDiv = document.getElementById("serviceDependsOnDiv");
                    
                    if(serviceDependsOnDiv.childNodes.length > 0)
                    {
                        clear(serviceDependsOnDiv);
                    }
                    
                    for(var i = 0; i < serviceParameters[currentIndex].length; ++i)
                    {
                        text = "Select The " + serviceParameters[currentIndex][i] + "s to include:";
                        
                        if(serviceParameters[currentIndex][i] == "Meter Size")
                        {
                            QuestionTxt(text, 6, serviceDependsOnDiv);
                            
                            Answer = document.createElement("span");
                            Answer.innerHTML = "";
                            
                            for(var j = 0; j  < survey.meterSizes.length; ++j)
                            {
                                var checkboxID = "meterSize" + j;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "createServiceChargeField()" value ="' + survey.meterSizes[j] + '"/>'+
                                '<label for = checkboxID>' + survey.meterSizes[j] + '"</label></br>';
                            }
                            serviceDependsOnDiv.appendChild(Answer);
                        }
                        else
                        {
                            QuestionTxt(text, 7, serviceDependsOnDiv);
                            
                            Answer = document.createElement("span");
                            Answer.innerHTML = "";
                             for(var j = 0; j  < survey.meterTypes.length; ++j)
                            {
                                var checkboxID = "meterType" + j;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "createServiceChargeField()" value ="' + survey.meterTypes[j] + '"/>'+
                                '<label for = checkboxID>' + survey.meterTypes[j] + '</label></br>';
                            }
                            serviceDependsOnDiv.appendChild(Answer);
                        }
                    }
                    
                    Answer = document.createElement("div");
                    Answer.id = "serviceChargesDiv";
                    serviceDependsOnDiv.appendChild(Answer);
                    
                    if(meterSizes[currentIndex] != null)
                    {
                        for(var i = 0; i < survey.meterSizes.length; ++i)
                        {
                            var isChecked = document.getElementById("meterSize" + i);
                            
                            for(var j = 0; j < meterSizes[currentIndex].length; ++j)
                            {
                                if(meterSizes[currentIndex][j] ==isChecked.value)
                                {
                                    isChecked.checked = true;
                                }
                            }
                        }
                    }
                    
                    if(meterTypes[currentIndex] != null)
                    {
                        for(var i = 0; i < survey.meterTypes.length; ++i)
                        {
                            var isChecked = document.getElementById("meterType" + i);
                            
                            for(var j = 0; j < meterTypes[currentIndex].length; ++j)
                            {
                                if(meterTypes[currentIndex][j] ==isChecked.value)
                                {
                                    isChecked.checked = true;
                                }
                            }
                        }
                    }
                    
                    if(meterTypes[currentIndex] != null || meterSizes[currentIndex] != null)
                    {
                        createServiceChargeField();
                    }
                }
                
                function UniformDepends()
                {
                    commodityStructure[currentIndex] = 'Uniform';
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt(survey.questions[8], 11, commodityDependsOnDiv);
                    
                    Answer = document.createElement("span");
                        
                    Answer.innerHTML = '<input type = "radio" id = "YesUniformDepends" name = "isUniformDependsOn" onclick = "getDepends(uniformParametersDiv, uniformParameters[currentIndex], \'uniform\')" value = "Yes" />'+
                    '<label for = "YesUniformDepends">Yes</label>'+
                    '<input type = "radio" id = "NoUniformDepends" name = "isUniformDependsOn" onclick = "getUniformRate()" value = "No"/>'+
                    '<label for = "NoCommodityCharge">No</label>';
                        
                    commodityDependsOnDiv.appendChild(Answer);
                    
                    var uniformParametersDiv = document.createElement("div");
                    uniformParametersDiv.id = "uniformParametersDiv";
                    commodityDependsOnDiv.appendChild(uniformParametersDiv);
                    
                    var uniformParametersValueDiv = document.createElement("div");
                    uniformParametersValueDiv.id = "uniformParametersValueDiv";
                    commodityDependsOnDiv.appendChild(uniformParametersValueDiv);
                    
                    var uniformPriceDiv = document.createElement("div");
                    uniformPriceDiv.id = "uniformPriceDiv";
                    commodityDependsOnDiv.appendChild(uniformPriceDiv);
                    
                    if(isUniformDependsOn[currentIndex] == 'Yes')
                    {
                        var Radio = document.getElementById("YesUniformDepends");
                        Radio.checked = true;
                        getDepends(uniformParametersDiv, uniformParameters[currentIndex], "uniform");
                    }
                    else if(isUniformDependsOn[currentIndex] == 'No')
                    {
                        var Radio = document.getElementById("NoUniformDepends");
                        Radio.checked = true;
                        getUniformRate();
                    }
                }
                
                function getUniformRate()
                {
                    var Radio = document.getElementById("NoUniformDepends");
                    
                    if(uniformPriceDiv.childNodes.length > 0)
                    {
                        clear(uniformPriceDiv);
                    }
                    
                    if(Radio.checked)
                    {
                        isUniformDependsOn[currentIndex] = 'No';
                        
                        var uniformParametersDiv = document.getElementById("uniformParametersDiv");
                        if(uniformParametersDiv.childNodes.length > 0)
                        {
                            clear(uniformParametersDiv);
                        }
                        if(uniformParametersValueDiv.childNodes.length > 0)
                        {
                            clear(uniformParametersValueDiv);
                        }
                    }
                    if(!Radio.checked)
                    {
                        isUniformDependsOn[currentIndex] = 'Yes';
                    }
                    
                    QuestionTxt("Enter The Cost Per CCF:", 12, uniformPriceDiv)
                    
                    if(isUniformDependsOn[currentIndex] == 'Yes')
                    {
                        var numberOfParameters = 1;
                        var ParametersToUse = [];
                        
                        for(var i = 0; i < uniformParameters[currentIndex].length; ++i)
                        {
                            switch(uniformParameters[currentIndex][i])
                            {
                                case 'Season': ParametersToUse[i] = season[currentIndex]; break;
                                case 'Temperature Zone': ParametersToUse[i] = temperatureZone[currentIndex]; break;
                                case 'Elevation Zone': ParametersToUse[i] = elevationZone[currentIndex]; break;
                                case 'Pressure Zone': ParametersToUse[i] = pressureZone[currentIndex]; break;
                                case 'Lot Size Group': ParametersToUse[i] = lotSizeGroup[currentIndex]; break;
                            }
                        }
                        if(ParametersToUse[0] != null)
                        {
                            commodityChargeCategories[currentIndex] = [];
                            for(var i = 0; i < ParametersToUse[0].length; ++i)
                            {
                                var FullParameter = "";
                                FullParameter = ParametersToUse[0][i];
                                if(ParametersToUse[1] != null)
                                {
                                    for(var j = 0; j < ParametersToUse[1].length; ++j)
                                    {
                                        FullParameter = ParametersToUse[0][i] + " " + ParametersToUse[1][j];
                                        if(ParametersToUse[2] != null)
                                        {
                                            for(var k = 0; k < ParametersToUse[2].length; ++k)
                                            {
                                                FullParameter = (ParametersToUse[0][i] + " " + ParametersToUse[1][j] + " " + ParametersToUse[2][k]);
                                                if(ParametersToUse[3] != null)
                                                {
                                                    for(var l = 0; l < ParametersToUse[3].length; ++l)
                                                    {
                                                        FullParameter = (ParametersToUse[0][i] + " " + ParametersToUse[1][j] + " " + ParametersToUse[2][k] + " " + ParametersToUse[3][l]);
                                                        if(ParametersToUse[4] != null)
                                                        {
                                                            for(var m = 0; m < ParametersToUse[4].length; ++m)
                                                            {
                                                                FullParameter = (ParametersToUse[0][i] + " " + ParametersToUse[1][j] + " " + ParametersToUse[2][k] + " " + ParametersToUse[3][l] + " " + ParametersToUse[4][m]);
                                                                FullParameter += " Rate:";
                                                                commodityChargeCategories[currentIndex].push(FullParameter);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            FullParameter += " Rate:";
                                                            commodityChargeCategories[currentIndex].push(FullParameter);
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    FullParameter += " Rate:";
                                                    commodityChargeCategories[currentIndex].push(FullParameter); 
                                                }
                                            }
                                        }
                                        else
                                        {
                                            FullParameter += " Rate:";
                                            commodityChargeCategories[currentIndex].push(FullParameter);
                                        }
                                    }
                                }
                                else
                                {
                                    FullParameter += " Rate:";
                                    commodityChargeCategories[currentIndex].push(FullParameter);
                                }
                            }
                        
                            for(var i = 0; i < commodityChargeCategories[currentIndex].length; ++i)
                            {
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", "commodityCharge" + i);
                                Answer.appendChild(document.createTextNode(commodityChargeCategories[currentIndex][i]));
                                uniformPriceDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "commodityCharge" + i;
                                uniformPriceDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                uniformPriceDiv.appendChild(BREAK);
                            }
                            
                            if(commodityCharges[currentIndex].length == commodityChargeCategories[currentIndex].length)
                            {
                                for(var i = 0; i < commodityCharges[currentIndex].length; ++i)
                                {
                                    var input = document.getElementById("commodityCharge" + i);
                                    input.value = commodityCharges[currentIndex][i];
                                }
                            }
                        }
                    }
                    else
                    {
                        var label = document.createElement("label");
                        label.setAttribute("for","uniformPrice0");
                        label.innerHTML = "Rate: ";
                        uniformPriceDiv.appendChild(label);
                        
                        Answer = document.createElement("input");
                        Answer.setAttribute("type", "text");
                        Answer.id = "uniformPrice0";
                        uniformPriceDiv.appendChild(Answer);
                    }
                }
                
                function TieredDepends()
                {
                    commodityStructure[currentIndex] = 'Tiered';
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt(survey.questions[9], 11, commodityDependsOnDiv);
                }
                
                function BudgetDepends()
                {
                    commodityStructure[currentIndex] = 'Budget';
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt("Coming Soon", 11, commodityDependsOnDiv);
                }
                
                
                function getDepends(DIV, identifier, Structure)
                {
                    if(DIV.childNodes.length > 0)
                    {
                        clear(DIV);
                    }
                    QuestionTxt(survey.questions[11] ,13, DIV);
                    
                    Answer = document.createElement("span");
                    for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                    {
                        var checkboxID = Structure + "DependsOn" + i;
                            Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "CommodityDependsOn" onclick = "storeCommodityDepends()" value ="' + survey.commodityDependsOn[i]+ '"/>'+
                            '<label for = "' + checkboxID + '">' + survey.commodityDependsOn[i] + '</label><br/>';
                    }
                    DIV.appendChild(Answer);
                    
                    if(identifier != null)
                    {
                        for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                        {
                            var checkCheckBox = document.getElementById(Structure + "DependsOn" + i)
                            for(var j = 0; j < identifier.length; ++j)
                            {
                                if(identifier[j] == checkCheckBox.value)
                                {
                                    checkCheckBox.checked = true;
                                }
                            }
                        }
                        storeCommodityDepends();
                    }
                    
                }
                
                function storeCommodityDepends()
                {
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        uniformParameters[currentIndex] = [];
                        pushParameters(uniformParameters[currentIndex], 'uniform');
                        
                        if(uniformParametersValueDiv.childNodes.length >  0)
                        {
                            clear(uniformParametersValueDiv);
                        }
                        
                        for(var i = 0; i < uniformParameters[currentIndex].length; ++i)
                        {
                            getParameterValues(uniformParameters[currentIndex][i], uniformParametersValueDiv, 'Uniform');
                        }
                        getUniformRate();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered')
                    {
                        
                    }
                    else if (commodityStructure[currentIndex] == 'Budget')
                    {
                        
                    }
                }
                
                function pushParameters(STRUCTURE, identifier)
                {
                    for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                    {
                        var checkCheckBox = document.getElementById(identifier + "DependsOn" + i);
                        
                        if(checkCheckBox.checked)
                        {
                            STRUCTURE.push(checkCheckBox.value);
                        }
                    }
                }
                
                function getParameterValues(parameter, DIV, identifier)
                {
                    QuestionTxt("Select the values for " + parameter ,13 , DIV)
                    
                    Answer = document.createElement("span");
                    
                    switch(parameter)
                    {
                        case 'Season': 
                            for(var i = 0; i < survey.season.length; ++i)
                            {   
                                var checkboxID = identifier + "Season" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'SeasonValues" onclick = "pushParameterValues()" value ="' + survey.season[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.season[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(season[currentIndex] != null)
                            {
                                for(var i = 0; i < survey.season.length; ++i)
                                {
                                    var checkCheckBox = document.getElementById(identifier + "Season" + i);
                                    for(var j = 0; j < season[currentIndex].length; ++j)
                                    {
                                        if(season[currentIndex][j] == checkCheckBox.value)
                                        {
                                            checkCheckBox.checked = true;
                                        }
                                    }
                                }
                            }
                            break;
                        case 'Temperature Zone':
                            for(var i = 0; i < survey.temperatureZone.length; ++i)
                            {   
                                var checkboxID = identifier + "TemperatureZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'TemperatureZoneValues" onclick = "pushParameterValues()" value ="' + survey.temperatureZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.temperatureZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(temperatureZone[currentIndex] != null)
                            {
                                for(var i = 0; i < survey.temperatureZone.length; ++i)
                                {
                                    var checkCheckBox = document.getElementById(identifier + "TemperatureZone" + i);
                                    for(var j = 0; j < temperatureZone[currentIndex].length; ++j)
                                    {
                                        if(temperatureZone[currentIndex][j] == checkCheckBox.value)
                                        {
                                            checkCheckBox.checked = true;
                                        }
                                    }
                                }
                            }
                            break;
                        case 'Elevation Zone':
                            for(var i = 0; i < survey.elevationZone.length; ++i)
                            {   
                                var checkboxID = identifier + "ElevationZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'ElevationZoneValues" onclick = "pushParameterValues()" value ="' + survey.elevationZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.elevationZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(elevationZone[currentIndex] != null)
                            {
                                for(var i = 0; i < survey.elevationZone.length; ++i)
                                {
                                    var checkCheckBox = document.getElementById(identifier + "ElevationZone" + i);
                                    for(var j = 0; j < elevationZone[currentIndex].length; ++j)
                                    {
                                        if(elevationZone[currentIndex][j] == checkCheckBox.value)
                                        {
                                            checkCheckBox.checked = true;
                                        }
                                    }
                                }
                            }
                            break;
                        case 'Pressure Zone':
                            for(var i = 0; i < survey.pressureZone.length; ++i)
                            {   
                                var checkboxID = identifier + "PressureZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'PressureZoneValues" onclick = "pushParameterValues()" value ="' + survey.pressureZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.pressureZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(pressureZone[currentIndex] != null)
                            {
                                for(var i = 0; i < survey.pressureZone.length; ++i)
                                {
                                    var checkCheckBox = document.getElementById(identifier + "pressureZone" + i);
                                    for(var j = 0; j < pressureZone[currentIndex].length; ++j)
                                    {
                                        if(pressureZone[currentIndex][j] == checkCheckBox.value)
                                        {
                                            checkCheckBox.checked = true;
                                        }
                                    }
                                }
                            }
                            break;
                        case 'Lot Size Group':
                            for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                            {   
                                var checkboxID = identifier + "LotSizeGroup" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'LotSizeGroupValues" onclick = "pushParameterValues()" value ="' + survey.lotSizeGroup[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.lotSizeGroup[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(lotSizeGroup[currentIndex] != null)
                            {
                                for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                                {
                                    var checkCheckBox = document.getElementById(identifier + "LotSizeGroup" + i);
                                    for(var j = 0; j < lotSizeGroup[currentIndex].length; ++j)
                                    {
                                        if(lotSizeGroup[currentIndex][j] == checkCheckBox.value)
                                        {
                                            checkCheckBox.checked = true;
                                        }
                                    }
                                }
                            }
                            break;
                    }
                }
                
                function pushParameterValues()
                {
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        for(var j = 0; j < uniformParameters[currentIndex].length; ++j)
                        {
                            switch(uniformParameters[currentIndex][j])
                            {
                                case 'Season': 
                                    season[currentIndex] = [];
                                    for(var i = 0; i < survey.season.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById("UniformSeason" + i);
                                        if(checkCheckBox.checked)
                                        { 
                                            season[currentIndex].push(checkCheckBox.value); 
                                        }
                                    } break;
                                case 'Temperature Zone':
                                    temperatureZone[currentIndex] = [];
                                    for(var i = 0; i < survey.temperatureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById("UniformTemperatureZone" + i);
                                        if(checkCheckBox.checked)
                                        { temperatureZone[currentIndex].push(checkCheckBox.value); }
                                    } break;
                                case 'Pressure Zone':
                                    pressureZone[currentIndex] = [];
                                    for(var i = 0; i < survey.pressureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById("UniformPressureZone" + i);
                                        if(checkCheckBox.checked)
                                        { pressureZone[currentIndex].push(checkCheckBox.value); }
                                    } break;
                                case 'Elevation Zone':
                                    elevationZone[currentIndex] = [];
                                    for(var i = 0; i < survey.elevationZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById("UniformElevationZone" + i);
                                        if(checkCheckBox.checked)
                                        { elevationZone[currentIndex].push(checkCheckBox.value); }
                                    } break;
                                case 'Lot Size Group':
                                    lotSizeGroup[currentIndex] = [];
                                    for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById("UniformLotSizeGroup" + i);
                                        if(checkCheckBox.checked)
                                        { lotSizeGroup[currentIndex].push(checkCheckBox.value); }
                                    } break;
                            }
                        }
                        
                        getUniformRate();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered')
                    {
                        
                    }
                    else if(commodityStructure[currentIndex] == 'Budget')
                    {
                        
                    }
                }
                
                function createServiceChargeField()
                {
                    var serviceChargesDiv = document.getElementById("serviceChargesDiv")
                    
                    if(serviceChargesDiv.childNodes.length > 0)
                    {
                        clear(serviceChargesDiv);
                    }
                    
                    meterSizes[currentIndex] = [];
                    
                    for(var i = 0; i < survey.meterSizes.length; ++i)
                    {
                        var tempID = "meterSize" + i;
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox == null)
                        {
                            i = survey.meterSizes.length;
                        }
                        else if(checkCheckBox.checked == true)
                        {
                            meterSizes[currentIndex].push(survey.meterSizes[i]);
                        }
                    }
                    
                    meterTypes[currentIndex] = []
                    
                    for(var i = 0; i < survey.meterTypes.length; ++i)
                    {
                        var tempID = "meterType" + i;
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox == null)
                        {
                            i = survey.meterTypes.length;
                        }
                        else if(checkCheckBox.checked == true)
                        {
                            meterTypes[currentIndex].push(survey.meterTypes[i]);
                        }
                    }
                    
                    serviceChargeCategories[currentIndex] = [];
                    if(meterTypes[currentIndex].length > 0 && meterSizes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charges in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterTypes[currentIndex].length; ++i)
                        {
                            for(var j = 0; j < meterSizes[currentIndex].length; ++j)
                            {
                                var tempCategory = meterTypes[currentIndex][i] + '|' + meterSizes[currentIndex][j]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.style.width = '300px';
                                Answer.innerHTML = meterTypes[currentIndex][i] + ' ' + meterSizes[currentIndex][j] + '"';
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "charge" + (j + i * meterSizes[currentIndex].length);
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                        }
                    }
                    else if (meterSizes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charges in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterSizes[currentIndex].length; ++i)
                            {
                                var tempCategory = meterSizes[currentIndex][i]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.innerHTML = meterSizes[currentIndex][i] + '"';
                                Answer.style.width = '300px';
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "charge" + i;
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                    }
                    else if (meterTypes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charge(s) in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterTypes[currentIndex].length; ++i)
                            {
                                var tempCategory = meterTypes[currentIndex][i]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.innerHTML = meterTypes[currentIndex][i];
                                Answer.style.width = '300px';
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "charge" + i;
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                    }
                    
                    if(serviceCharges[currentIndex] != null && serviceCharges[currentIndex].length == serviceChargeCategories[currentIndex].length)
                    {
                        for(var i = 0; i < serviceChargeCategories[currentIndex].length; ++i)
                        {
                            var tempCharge = document.getElementById("charge" + i);
                            
                            tempCharge.value = serviceCharges[currentIndex][i];
                        }
                    }
                    else
                    {
                        serviceCharges[currentIndex] = [];
                    }
                }
                
                
                
                
                function PreviousGetAnswers()
                {
                    
                    if(currentIndex == 0)
                    {
                        MainPage();
                    }
                    else
                    {   
                        currentIndex -= 1;
                        RateStructure(currentIndex);
                    }
                }
                
                function NextGetAnswers()
                {
                    var Continue = true;
                    if(isServiceCharge[currentIndex])
                    {
                        if(serviceParameters[currentIndex] == null)
                        {
                            alert("You must select what the Service Charge Depends On");
                            Continue = false;
                        }
                        else
                        {
                            for(var i = 0; i < serviceParameters[currentIndex].length; ++i)
                            {
                                if(serviceParameters[currentIndex][i] == "Meter Size")
                                {
                                    if(meterSizes[currentIndex] == null)
                                    {
                                        alert("Select A Meter Size or Deselect The Meter Size Option");
                                        Continue = false;
                                    }
                                }
                                else if(serviceParameters[currentIndex][i] == "Meter Type")
                                {
                                    if(meterTypes[currentIndex] == null)
                                    {
                                        alert("Select A Meter Type or Deselect The Meter Type Option");
                                        Continue = false;
                                    }
                                }
                            }
                        }
                        if(Continue)
                        {
                            serviceCharges[currentIndex] = []
                            for(var i = 0; i < serviceChargeCategories[currentIndex].length; ++i)
                            {
                                var tempCharge = document.getElementById("charge" + i);
                        
                                if(tempCharge.value == "")
                                {
                                    alert("Service Charge at row " + (i + 1) + " isn't filled out");
                                    Continue = false;
                                }
                                else
                                {
                                    serviceCharges[currentIndex].push(tempCharge.value);
                                }
                            }
                            
                        }
                    }
                    if(isCommodityCharge[currentIndex])
                    {
                        switch(commodityStructure[currentIndex])
                        {
                            case 'Uniform': 
                            commodityCharges[currentIndex] = []
                            if(isUniformDependsOn == "No")
                            {
                                var Charge = document.getElementById("uniformPrice0");
                                commodityCharges[currentIndex][0] = Charge.value;
                            }
                            else
                            {
                              if(uniformParameters[currentIndex].length != 0)
                              {
                                  for(var i = 0; i < uniformParameters[currentIndex].length; ++i)
                                  {
                                      switch(uniformParameters[currentIndex][i])
                                      {
                                          case "Season":
                                            if(season[currentIndex] == null)
                                            {
                                                Continue = false;
                                                alert("No parameters selected for Season");
                                            } break;
                                          case "Temperature Zone":
                                            if(temperatureZone[currentIndex] == null)
                                            {
                                                Continue = false;
                                                alert("No parameters selected for Temperature Zone");
                                            } break;
                                          case "Elevation Zone":
                                            if(elevationZone[currentIndex] == null)
                                            {
                                                Continue = false;
                                                alert("No parameters selected for Elevation Zone");
                                            } break;
                                          case "Pressure Zone":
                                            if(pressureZone[currentIndex] == null)
                                            {
                                                Continue = false;
                                                alert("No parameters selected for Pressure Zone");
                                            } break;
                                          case "Lot Size Group":
                                            if(lotSizeGroup[currentIndex] == null)
                                            {
                                                Continue = false;
                                                alert("No parameters selected for Lot Size Group");
                                            } break;
                                      }
                                  }
                                  
                                  if(Continue)
                                  {
                                     commodityCharges[currentIndex] = []
                                    for(var i = 0; i < commodityChargeCategories[currentIndex].length; ++i)
                                    {
                                        var tempCharge = document.getElementById("uniformPrice" + i);
                                
                                        if(tempCharge.value == "")
                                        {
                                            alert("Commodity Charge at row " + (i + 1) + " isn't filled out");
                                            Continue = false;
                                        }
                                        else
                                        {
                                            commodityCharges[currentIndex].push(tempCharge.value);
                                        }
                            } 
                                  }
                              }                                  
                            }
                            
                            break;
                            case 'Tiered': break;
                            case 'Budget': break;
                        }
                    }
                    if(Continue)
                    {
                        if(currentIndex == SelectedRateStructures.length - 1)
                        {
                            Complete();
                        }
                        else
                        {
                            currentIndex += 1;
                            RateStructure(currentIndex);
                        }
                    }
                }
                
                function Complete()
                {
                    var OWRSformat = {
                       "metadata" : {
                            "effective_date" : "" + EffectiveDate + "",
                            "utility_name" : "" + UtilityName + "",
                            "bill_frequency" : "" + BillFrequency + ""
                       }, 
                       "rate_structure" : {
                       
                       }
                    };
                    
                    for(var structure in SelectedRateStructures)
                    {
                        var tempStructure; 
                        
                        var serviceJSON;
                        
                        if(isServiceCharge[structure])
                        {
                            serviceJSON = {
                                "depends_on" : [],
                                "values" : {}
                            };
                            
                            for(var parameter in serviceParameters[structure])
                            {
                                if(serviceParameters[structure][parameter] == "Meter Size")
                                {
                                    serviceJSON.depends_on.push("meter_size");
                                }
                                else if(serviceParameters[structure][parameter] == "Meter Type")
                                {
                                    serviceJSON.depends_on.push("meter_type");
                                }
                            }
                            
                            var valueStorage = '{';
                            for(var value in serviceCharges[structure])
                            {
                                if(value == serviceCharges[structure].length - 1)
                                {
                                    valueStorage += '"' + serviceChargeCategories[structure][value] + '" : "' + serviceCharges[structure][value] + '" }'
                                }
                                else
                                {
                                    valueStorage += '"' + serviceChargeCategories[structure][value] + '" : "' + serviceCharges[structure][value] + '", '
                                }
                            }
                            serviceJSON.values = JSON.parse(valueStorage);
                        }
                        else
                        { serviceJSON = 0; }
                        
                        switch(SelectedRateStructures[structure])
                        {
                            case "RESIDENTIAL_SINGLE": tempStructure = { "RESIDENTIAL_SINGLE" : { "service_charge" : {} } };
                                                        tempStructure.RESIDENTIAL_SINGLE.service_charge = serviceJSON ; break;
                            case "RESIDENTIAL_MULTI": tempStructure = { "RESIDENTIAL_MULTI" : { "service_charge" : {} } }; 
                                                        tempStructure.RESIDENTIAL_MULTI.service_charge = serviceJSON; break;
                            case "IRRIGATION": tempStructure = { "IRRIGATION" : { "service_charge" : {} } }; 
                                                        tempStructure.IRRIGATION.service_charge = serviceJSON; break;
                            case "COMMERCIAL": tempStructure = { "COMMERCIAL" : { "service_charge" : {} } }; 
                                                        tempStructure.COMMERCIAL.service_charge = serviceJSON; break;
                            case "INDUSTRIAL": tempStructure = { "INDUSTRIAL" : { "service_charge" : {} } }; 
                                                        tempStructure.INDUSTRIAL.service_charge = serviceJSON; break;
                            case "INSTITUTIONAL": tempStructure = { "INSTITUTIONAL" : { "service_charge" : {} } }; 
                                                        tempStructure.INSTITUTIONAL.service_charge = serviceJSON; break;
                            case "FIRE_SERVICE": tempStructure = { "FIRE_SERVICE" : { "service_charge" : {} } }; 
                                                        tempStructure.FIRE_SERVICE.service_charge = serviceJSON; break;
                            case "NONPOTABLE": tempStructure = { "NONPOTABLE" : { "service_charge" : {} } }; 
                                                        tempStructure.NONPOTABLE.service_charge = serviceJSON; break;
                            case "NON_RESIDENTIAL": tempStructure = { "NON_RESIDENTIAL" : { "service_charge" : {} } }; 
                                                        tempStructure.NON_RESIDENTIAL.service_charge = serviceJSON; break;
                            case "UNMETERED": tempStructure = { "UNMETERED" : { "service_charge" : {} } }; 
                                                        tempStructure.UNMETERED.service_charge = serviceJSON; break;
                            case "RECLAIMED": tempStructure = { "RECLAIMED" : { "service_charge" : {} } }; 
                                                        tempStructure.RECLAIMED.service_charge = serviceJSON; break;
                            case "GOVERNMENTAL": tempStructure = { "GOVERNMENTAL" : { "service_charge" : {} } }; 
                                                        tempStructure.GOVERNMENTAL.service_charge = serviceJSON; break;
                            case "INTERRUPTIBLE": tempStructure = { "INTERRUPTIBLE" : { "service_charge" : {} } }; 
                                                        tempStructure.INTERRUPTIBLE.service_charge = serviceJSON; break;
                            case "DOCKS SHIPPING": tempStructure = { "DOCKS_SHIPPING" : { "service_charge" : {} } }; 
                                                        tempStructure.DOCKS_SHIPPING.service_charge = serviceJSON; break;
                            case "BUILDING CONTRACTOR": tempStructure = { "BUILDING_CONTRACTOR" : { "service_charge" : {} } }; 
                                                        tempStructure.BUILDING_CONTRACTOR.service_charge = serviceJSON; break;
                            case "RESIDENTIAL CONSTRUCTION": tempStructure = { "RESIDENTIAL_CONSTRUCTION" : { "service_charge" : {} } }; 
                                                        tempStructure.RESIDENTIAL_CONSTRUCTION.service_charge = serviceJSON; break;
                            case "OTHER": tempStructure = { "OTHER" : { "service_charge" : {} } }; 
                                                        tempStructure.OTHER.service_charge = serviceJSON; break;
                        }
                        
                        OWRSformat.rate_structure = jQuery.extend({}, OWRSformat.rate_structure, tempStructure);
                    }
                    
                    var YAML = jsyaml.safeDump(OWRSformat);
                    
                    var cleared = document.getElementById("surveyContainer");
                    clear(cleared);
                    
                    var TheEnd = document.createElement("h1");
                    TheEnd.appendChild(document.createTextNode("Thank You"));
                    cleared.appendChild(TheEnd);
                    
                    alert(YAML);
                }
                
                function QuestionTxt(question, number, Parent)
                {
                    Question = document.createElement("p");
                    Question.appendChild(document.createTextNode(question));
                    Question.setAttribute("id", "question" + number);
                    Parent.appendChild(Question);
                }
                
                function clear(parent)
                {
                    while(parent.firstChild)
                    {  parent.removeChild(parent.firstChild); }
                }
                
                MainPage();