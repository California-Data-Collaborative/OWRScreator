var surveyJSON = '{"title": "Create OWRS files",' +
'"utilities": [' +
'"Irvine Ranch Water District",'+
'"Eastern Municipal Water District",'+
'"Santa Margarita Water District",'+
'"Western Municipal Water District of Riverside",'+
'"Monte Vista Water District",'+
'"Santa Rosa  City of",'+
'"Las Virgenes Municipal Water District",'+
'"Sacramento  City of",'+
'"Los Angeles Department of Water and Power",'+
'"East Bay Municipal Utilities District",'+
'"San Diego  City of",'+
'"San Jose Water Company",'+
'"San Francisco Public Utilities Commission",'+
'"Fresno  City of",'+
'"Long Beach  City of",'+
'"Anaheim  City of",'+
'"Alameda County Water District",'+
'"Riverside  City of",'+
'"Santa Ana  City of",'+
'"Coachella Valley Water District",'+
'"California Water Service Company Bakersfield",'+
'"San Gabriel Valley Water Company",'+
'"Helix Water District",'+
'"Golden State Water Company Southwest",'+
'"Modesto, City of",'+
'"Otay Water District",'+
'"San Gabriel Valley Fontana Water Company",'+
'"Los Angeles County Public Works Waterworks District 40",'+
'"Oxnard  City of",'+
'"Cucamonga Valley Water District",'+
'"California-American Water Company Sacramento District",'+
'"Contra Costa Water District",'+
'"San Bernardino  City of",'+
'"Huntington Beach  City of",'+
'"Glendale  City of",'+
'"Sweetwater Authority",'+
'"Marin Municipal Water District",'+
'"Corona  City of",'+
'"Suburban Water Systems San Jose Hills",'+
'"Stockton  City of",'+
'"Sacramento County Water Agency",'+
'"Garden Grove  City of",'+
'"Sacramento Suburban Water District",'+
'"Oceanside  City of",'+
'"California Water Service Company Stockton",'+
'"Moulton Niguel Water District",'+
'"Ontario  City of",'+
'"Pasadena  City of",'+
'"Rancho California Water District",'+
'"California Water Service Company East Los Angeles",'+
'"Hayward  City of",'+
'"Pomona  City of",'+
'"Elsinore Valley Municipal Water District",'+
'"Sunnyvale  City of",'+
'"Escondido  City of",'+
'"Bakersfield  City of",'+
'"California Water Service Company Dominguez",'+
'"California Water Service Company Visalia",'+
'"Orange  City of",'+
'"Fullerton  City of",'+
'"California Water Service Company Mid Peninsula",'+
'"Park Water Company",'+
'"Roseville  City of",'+
'"El Dorado Irrigation District",'+
'"Vista Irrigation District",'+
'"Victorville Water District",'+
'"Vallejo  City of",'+
'"Castaic Lake Water Agency Santa Clarita Water Division",'+
'"California Water Service Company Salinas District",'+
'"Santa Clara  City of",'+
'"Valencia Water Company",'+
'"Jurupa Community Service District",'+
'"San Jose  City of",'+
'"Palmdale Water District",'+
'"Inglewood  City of",'+
'"Suburban Water Systems Whittier/La Mirada",'+
'"San Buenaventura  City of",'+
'"Walnut Valley Water District",'+
'"Downey  City of",'+
'"Clovis  City of",'+
'"Golden State Water Company West Orange",'+
'"Mesa Water District",'+
'"Azusa  City of",'+
'"Daly City  City of",'+
'"Fairfield  City of",'+
'"Antioch  City of",'+
'"Burbank  City of",'+
'"Torrance  City of",'+
'"Desert Water Agency",'+
'"East Valley Water District",'+
'"California Water Service Company Chico District",'+
'"California-American Water Company Los Angeles District",'+
'"South Gate  City of",'+
'"Santa Maria  City of",'+
'"California-American Water Company Monterey District",'+
'"Great Oaks Water Company Incorporated",'+
'"Placer County Water Agency",'+
'"Vallecitos Water District",'+
'"California Water Service Company Hermosa/Redondo",'+
'"California-American Water Company San Diego District",'+
'"Santa Cruz  City of",'+
'"Westminster  City of",'+
'"Santa Monica  City of",'+
'"Santa Barbara  City of",'+
'"Hesperia Water District City of",'+
'"Redding  City of",'+
'"Ventura County Waterworks District No. 8",'+
'"Vacaville  City of",'+
'"Padre Dam Municipal Water District",'+
'"Indio  City of",'+
'"Redwood City  City of",'+
'"Goleta Water District",'+
'"Napa  City of",'+
'"Carlsbad Municipal Water District",'+
'"Tracy  City of",'+
'"Redlands  City of",'+
'"Alhambra  City of",'+
'"Olivenhain Municipal Water District",'+
'"Merced  City of",'+
'"Buena Park  City of",'+
'"Compton  City of",'+
'"Dublin San Ramon Services District",'+
'"Yorba Linda Water District",'+
'"Chino  City of",'+
'"Chino Hills  City of",'+
'"Mountain View  City of",'+
'"Upland  City of",'+
'"Manteca  City of",'+
'"Pleasanton  City of",'+
'"West Valley Water District",'+
'"California Water Service Company Bear Gulch",'+
'"Lynwood  City of",'+
'"Turlock  City of",'+
'"Valley County Water District",'+
'"Milpitas  City of",'+
'"California Water Service Company Los Altos/Suburban",'+
'"California Water Service Company Palos Verdes",'+
'"Yuba City  City of",'+
'"Davis  City of",'+
'"Tustin  City of",'+
'"Citrus Heights Water District",'+
'"Folsom  City of",'+
'"Newport Beach  City of",'+
'"Pittsburg  City of",'+
'"Watsonville  City of",'+
'"Golden State Water Company Florence Graham",'+
'"Madera  City of",'+
'"Whittier  City of",'+
'"Palo Alto  City of",'+
'"Huntington Park  City of",'+
'"Lodi  City of Public Works Department",'+
'"La Habra  City of Public Works",'+
'"Apple Valley Ranchos Water Company",'+
'"Tulare, City of",'+
'"Monterey Park  City of",'+
'"California-American Water Ventura District",'+
'"Rowland Water District",'+
'"North Marin Water District",'+
'"Petaluma  City of",'+
'"Porterville  City of",'+
'"California Water Service Company South San Francisco",'+
'"Hanford  City of",'+
'"Fountain Valley  City of",'+
'"Lakewood  City of",'+
'"California Water Service Company Livermore",'+
'"Brentwood  City of",'+
'"Paramount  City of",'+
'"Golden State Water Company Bell-Bell Gardens",'+
'"Arcadia  City of",'+
'"Woodland  City of",'+
'"Delano  City of",'+
'"San Clemente  City of",'+
'"Gilroy  City of",'+
'"Golden State Water Company San Dimas",'+
'"Rialto  City of",'+
'"Colton, City of",'+
'"Lake Hemet Municipal Water District",'+
'"Poway  City of",'+
'"Thousand Oaks  City of",'+
'"Glendora  City of",'+
'"Beverly Hills  City of",'+
'"West Sacramento  City of",'+
'"Cerritos  City of",'+
'"Calaveras County Water District",'+
'"El Toro Water District",'+
'"Golden State Water Company Artesia",'+
'"Ceres  City of",'+
'"Camarillo  City of",'+
'"Golden State Water Company Placentia",'+
'"Bellflower-Somerset Mutual Water Company",'+
'"Lincoln  City of",'+
'"San Luis Obispo  City of",'+
'"Coachella  City of",'+
'"Newhall County Water District",'+
'"San Gabriel County Water District",'+
'"Yucaipa Valley Water District",'+
'"El Centro  City of",'+
'"Nevada Irrigation District",'+
'"Hawthorne  City of",'+
'"Elk Grove Water Service",'+
'"Golden State Water Company Norwalk",'+
'"San Bruno  City of",'+
'"Golden State Water Company Cordova",'+
'"Morgan Hill  City of",'+
'"Rohnert Park  City of",'+
'"Golden State Water Company Simi Valley",'+
'"Brea  City of",'+
'"Lake Arrowhead Community Services District",'+
'"Beaumont-Cherry Valley Water District",'+
'"Lompoc  City of",'+
'"Calexico  City of",'+
'"Diablo Water District",'+
'"Soquel Creek Water District",'+
'"San Juan Capistrano  City of",'+
'"Covina  City of ",'+
'"Monrovia  City of",'+
'"Pico Rivera  City of",'+
'"North Coast County Water District",'+
'"Ventura County Waterworks District No 1",'+
'"Carmichael Water District",'+
'"Mission Springs Water District",'+
'"San Dieguito Water District",'+
'"Estero Municipal Improvement District",'+
'"Los Banos, City of",'+
'"Golden State Water Company Claremont",'+
'"San Juan Water District",'+
'"Ramona Municipal Water District",'+
'"Fair Oaks Water District",'+
'"Golden State Water Company Culver City",'+
'"Manhattan Beach  City of",'+
'"Camrosa Water District",'+
'"Lakeside Water District",'+
'"Martinez  City of",'+
'"South Coast Water District",'+
'"Fallbrook Public Utility District",'+
'"Marina Coast Water District",'+
'"Oildale Mutual Water Company",'+
'"South Tahoe Public Utilities District",'+
'"Truckee-Donner Public Utilities District",'+
'"Adelanto City of",'+
'"La Verne  City of",'+
'"Montebello Land and Water Company",'+
'"Crescenta Valley Water District",'+
'"Rubidoux Community Service District",'+
'"Livermore  City of Division of Water Resources",'+
'"Golden State Water Company Orcutt",'+
'"Atascadero Mutual Water Company",'+
'"East Niles Community Service District",'+
'"Vaughn Water Company",'+
'"Golden State Water Company Barstow",'+
'"Indian Wells Valley Water District",'+
'"Burlingame  City of",'+
'"Tuolumne Utilities District",'+
'"Sunny Slope Water Company",'+
'"Paso Robles  City of",'+
'"Banning  City of",'+
'"Santa Paula  City of",'+
'"Hemet  City of",'+
'"Rincon Del Diablo Municipal Water District",'+
'"Suisun-Solano Water Authority",'+
'"Atwater  City of",'+
'"Alco Water Service",'+
'"East Palo Alto, City of",'+
'"Windsor, Town of",'+
'"Benicia  City of",'+
'"Brawley  City of",'+
'"Golden State Water Company S San Gabriel",'+
'"Norco  City of",'+
'"Eureka  City of",'+
'"Golden State Water Company S Arcadia",'+
'"Mid-Peninsula Water District",'+
'"South Pasadena  City of",'+
'"Wasco  City of",'+
'"Paradise Irrigation District",'+
'"City of Big Bear Lake, Dept of Water & Power",'+
'"Sanger  City of",'+
'"Orchard Dale Water District",'+
'"Seal Beach  City of",'+
'"Valley Center Municipal Water District",'+
'"Lemoore  City of",'+
'"Pico Water District",'+
'"Phelan Pinon Hills Community Services District",'+
'"California Water Service Company Selma",'+
'"Hi-Desert Water District",'+
'"Dinuba  City of",'+
'"Galt  City of",'+
'"Reedley  City of",'+
'"Corcoran, City of",'+
'"Valley of the Moon Water District",'+
'"Loma Linda  City of *",'+
'"Riverbank  City of",'+
'"San Fernando  City of",'+
'"Amador Water Agency",'+
'"Hollister  City of",'+
'"El Monte  City of",'+
'"Golden State Water Company Bay Point",'+
'"Los Angeles County Public Works Waterworks District 29",'+
'"Oakdale  City of",'+
'"Port Hueneme  City of",'+
'"Millbrae  City of",'+
'"Fruitridge Vista Water Company",'+
'"West Kern Water District",'+
'"Patterson  City of",'+
'"Laguna Beach County Water District",'+
'"Arvin Community Services District",'+
'"Lomita  City of",'+
'"Lathrop, City of ",'+
'"Quartz Hill Water District",'+
'"American Canyon, City of",'+
'"Humboldt Community Service District",'+
'"Lamont Public Utility District",'+
'"Santa Fe Irrigation District",'+
'"Sunnyslope County Water District",'+
'"Rainbow Municipal Water District",'+
'"Olivehurst Public Utility District",'+
'"California Water Service Company Westlake",'+
'"Shafter  City of",'+
'"San Lorenzo Valley Water District",'+
'"Linda County Water District",'+
'"Twentynine Palms Water District",'+
'"Arcata  City of",'+
'"Bella Vista Water District",'+
'"Crescent City  City of",'+
'"Norwalk City of",'+
'"South Feather Water and Power Agency",'+
'"Santa Fe Springs  City of",'+
'"Imperial, City of",'+
'"San Jacinto  City of",'+
'"Greenfield, City of",'+
'"Rosamond Community Service District",'+
'"Tahoe City Public Utilities District",'+
'"Arroyo Grande  City of",'+
'"McKinleyville Community Service District",'+
'"Bakman Water Company",'+
'"Soledad, City of",'+
'"Mammoth Community Water District",'+
'"Pinedale County Water District",'+
'"Coastside County Water District",'+
'"El Segundo  City of",'+
'"Coalinga City of",'+
'"Orange Vale Water Company",'+
'"Lincoln Avenue Water Company",'+
'"Ukiah  City of",'+
'"Menlo Park  City of",'+
'"Mountain House Community Services District",'+
'"La Palma  City of",'+
'"Lee Lake Water District",'+
'"Riverside Highland Water Company",'+
'"Ripon  City of",'+
'"Fillmore  City of",'+
'"California Water Service Company King City",'+
'"Discovery Bay Community Services District",'+
'"Livingston  City of",'+
'"Carpinteria Valley Water District",'+
'"Kerman, City of",'+
'"California City  City of",'+
'"San Bernardino County Service Area 64",'+
'"Red Bluff  City of",'+
'"Westborough Water District",'+
'"Blythe  City of",'+
'"Montecito Water District",'+
'"Nipomo Community Services District",'+
'"Trabuco Canyon Water District",'+
'"Grover Beach  City of",'+
'"Big Bear City Community Services District",'+
'"California Water Service Company Marysville",'+
'"Triunfo Sanitation District / Oak Park Water Service",'+
'"Fortuna  City of",'+
'"Healdsburg  City of",'+
'"Kingsburg, City of",'+
'"Sonoma  City of",'+
'"San Bernardino County Service Area 70J",'+
'"California Water Service Company Oroville",'+
'"Anderson, City of",'+
'"Sierra Madre  City of",'+
'"Rio Linda - Elverta Community Water District",'+
'"Hillsborough  Town of",'+
'"City of Newman Water Department",'+
'"Morro Bay  City of",'+
'"Exeter  City of",'+
'"Scotts Valley Water District",'+
'"Shasta Lake  City of",'+
'"California Water Service Company Dixon, City of",'+
'"Casitas Municipal Water District",'+
'"Valley Water Company",'+
'"Georgetown Divide Public Utilities District",'+
'"Del Oro Water Company",'+
'"Rubio Canyon Land and Water Association",'+
'"Joshua Basin Water District",'+
'"Susanville  City of",'+
'"Myoma Dunes Mutual Water Company",'+
'"Perris, City of",'+
'"Tehachapi, City of",'+
'"Winton Water & Sanitary District",'+
'"Rio Vista, city of",'+
'"Pismo Beach  City of",'+
'"Yreka, City of",'+
'"Sweetwater Springs Water District",'+
'"Crestline Village Water District",'+
'"North Tahoe Public Utility District",'+
'"Golden State Water Company Cowan Heights",'+
'"California Water Service Company Willows",'+
'"Cambria Community Services District",'+
'"California Water Service Company Kern River Valley",'+
'"East Orange County Water District",'+
'"California Water Service Company Redwood Valley",'+
'"California Water Service Company Antelope Valley",'+
'"Groveland Community Services District",'+
'"Humboldt Bay Municipal Water District",'+
'"Vernon  City of"],'+
'"questions": ["Enter the Name of the Utility:", "Enter the Bill Frequency:",'+
'"Enter the Effective Date of this Rate Structure:", "Select the Customer Classes Used by the Utility:",'+
' "Does this Customer Class contain a Service Charge?", "Does the Service Charge depend on the following:",'+
'"Does this Customer Class contain a Commodity Charge?", "What type of Commodity Charge does this Customer Class Contain?",'+
'"Does this Uniform Commodity Charge Depend On Anything?", "How Many Tiers are There?",' +
' "Do the Tier Levels Depend On Anything?", "Select the parameters to include:",'+
' "Do the Tier Prices Depend On Anything?"],'+
'"billFrequency": ["Monthly", "BiMonthly", "Quarterly", "Annually", "Other"],'+
'"rateStructures":['+
'"Residential Single", "Residential Multi",'+
'"Irrigation", "Commercial",'+
'"Industrial", "Institutional",'+
'"Fire Service", "Non-Potable",'+
'"Non-Residential", "Unmetered",'+
'"Reclaimed", "Governmental",'+
'"Interruptible", "Docks Shipping",'+
'"Building Contractor", "Residential Construction",'+
'"Other"],'+
'"serviceDependsOn": ["Meter Size", "Meter Type"],'+
'"commodityDependsOn": ["Season", "Temperature Zone", "Elevation Zone", "Pressure Zone", "Lot Size Group", "Meter Size", "Month"],'+
'"meterSizes": ["5/8","3/4", "1", "1 1/2", "2", "3", "4", "6", "8", "10", "12", "14", "16", "18"],'+
'"meterTypes": ["Disc", "Compound", "Turbo", "Magnetic Meter", "Propeller", "Omni F2"],'+
'"season": ["Summer", "Winter"],'+
'"temperatureZone": ["Low", "Medium", "High"], '+
'"elevationZone":["1", "2", "3", "4", "5"],'+
'"pressureZone":["1", "2", "3", "4", "5"],'+
'"lotSizeGroup":["1", "2", "3", "4", "5"],'+
'"month": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}'
var survey = JSON.parse(surveyJSON)

                var form = document.getElementById("survey");
                var title = document.getElementById("Header");
                var subtitle = document.getElementById("lilHeader");
                var currentIndex = 0;
                
                var Question;
                var Answer;
                var text;
                
                var UtilityName = "";
                var BillFrequency = "";
                var EffectiveDate = "";
                var SelectedRateStructures = [];
                
                var serviceParameters = [];
                var meterSizes = [];
                var meterTypes = [];
                var serviceChargeCategories = [];
                var serviceCharges = [];
                var isServiceCharge = [];
                var ParametersToUse = [];
                
                var uniformParameters = [];
                var commodityStructure = [];
                var numOfTiers = [];
                var tierStartsParameters = [];
                var tierStarts = [];
                var isTierStartsDepends = [];
                var tierStartsValues = [];
                var tierStartsCategories = [];
                var tierPricesParameters = [];
                var tierPrices = [];
                var isTierPricesDepends = [];
                var tierLevels = [];
                var uniformPrices = [];
                var isCommodityCharge = [];
                var isUniformDependsOn = [];
                var commodityChargeCategories = [];
                var commodityCharges = [];
                var tierStartsDependsOn = [];
                var tierPricesDependsOn = [];
                
                var gpcd = [];
                var indoor = [];
                var outdoor = [];
                
                var uniformDependsOn = [];
                var commodityMeterSize = [];
                var month = [];
                var season = [];
                var elevationZone = [];
                var pressureZone = [];
                var temperatureZone = [];
                var lotSizeGroup = [];
                
                
                
                function MainPage()
                {
                    
                    title.innerHTML = survey.title;
                    subtitle.innerHTML = "";
                    clear(form);
                    
                    QuestionTxt(survey.questions[0], 1, form);
                
                    Answer = document.createElement("select");
                
                    for(var i = 0; i < survey.utilities.length; ++i)
                    {
                        Answer.appendChild(new Option(survey.utilities[i], survey.utilities[i]));
                    }
                    Answer.id = "utilityName";
                    form.appendChild(Answer);
                
                    QuestionTxt(survey.questions[1], 2, form);
                
                    Answer = document.createElement("select");
                
                    for(var i = 0; i < survey.billFrequency.length; ++i)
                    {
                        Answer.appendChild(new Option(survey.billFrequency[i], survey.billFrequency[i]));
                    }
                    Answer.id = "billFrequency";
                    form.appendChild(Answer);
                    
                    QuestionTxt(survey.questions[2], 3, form);
                    
                    Answer = document.createElement("input");
                    Answer.setAttribute("type", "date");
                    Answer.id = "effectiveDate";
                    form.appendChild(Answer);
                    
                    QuestionTxt(survey.questions[3], 4, form);
                    
                    for(var i = 0; i < survey.rateStructures.length; ++i)
                    {
                        Answer = document.createElement("input");
                        Answer.setAttribute("type", "checkbox"); Answer.class = "custClass";
                        Answer.id = "custClass" + i; Answer.Value = survey.rateStructures[i];
                        form.appendChild(Answer);
                        
                        Answer = document.createElement("label");
                        Answer.setAttribute("for", "custClass" + i);
                        Answer.appendChild(document.createTextNode(survey.rateStructures[i]));
                        form.appendChild(Answer); 
                        var BREAK = document. createElement("br");
                        form.appendChild(BREAK);
                    }
                    
                    var ButtonDiv = document.createElement("div");
                    ButtonDiv.style.marginTop = "15px";
                    form.appendChild(ButtonDiv);
                    
                    var Button = document.createElement("span");
                    Button.id = "nextButton";
                    Button.innerHTML = '<button type = "button" onclick = "GetMainPageAnswers()">Next</button>';
                    ButtonDiv.appendChild(Button);
                    
                    if(UtilityName != "")
                    {
                        document.getElementById("utilityName").value = UtilityName;
                        document.getElementById("billFrequency").value = BillFrequency;
                        document.getElementById("effectiveDate").value = EffectiveDate;
                        
                        for(var i = 0; i < 17; ++i)
                        {
                            var temp = document.getElementById("custClass" + i);
                            
                            check = false;
                            for(var j = 0; j < SelectedRateStructures.length; ++j)
                            {
                                var test = survey.rateStructures[i];
                                
                                if( test == SelectedRateStructures[j])
                                {
                                    var check = true;
                                }
                            }
                            
                            if(check)
                            {
                                temp.checked = true;
                            }
                        }
                    }
                    
                }
                
                function GetMainPageAnswers()
                {
                    SelectedRateStructures = [];
                    UtilityName = document.getElementById("utilityName").value;
                    BillFrequency = document.getElementById("billFrequency").value;
                    EffectiveDate = document.getElementById("effectiveDate").value;
                    
                    var date = true;
                    if(EffectiveDate == "")
                    { 
                        alert("Must select an Effective Date for the Rate Structure");
                        date = false;
                    }
                    
                    var noneChecked = true;
                    for(var numOfCheckBoxes = 0; numOfCheckBoxes < 17; ++numOfCheckBoxes)
                    {
                        var temp = document.getElementById("custClass" + numOfCheckBoxes);
                        
                        
                        if(temp.checked == true)
                        { 
                            SelectedRateStructures.push(survey.rateStructures[numOfCheckBoxes]);
                            noneChecked = false;
                        }
                    }
                    if(noneChecked)
                    { alert("Please Select A Customer Class"); }
                    
                    if(!noneChecked && date)
                    RateStructure(currentIndex);
                }
                
                
                
                
                function RateStructure(index)
                {
                    title.innerHTML = UtilityName;
                    subtitle.innerHTML = SelectedRateStructures[index];
                    clear(form);
                    
                    var serviceList = document.createElement("div");
                    serviceList.id = "serviceList";
                    form.appendChild(serviceList);
                    
                    QuestionTxt(survey.questions[4], 5, serviceList);
                    
                    Answer = document.createElement("span");
                    
                    if(isServiceCharge[currentIndex])
                    {
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No" />'+
                        '<label for = "NoServiceCharge">No</label>';
                        serviceList.appendChild(Answer);
                        getServiceChargeInfo();
                    }
                    else
                    {  
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes" />'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoServiceCharge">No</label>';
                        serviceList.appendChild(Answer);
                    }
                    
                    var BREAK = document.createElement("br");
                    serviceList.appendChild(BREAK);
                    
                    var commodityList = document.createElement("div");
                    commodityList.id = "commodityList";
                    form.appendChild(commodityList);
                    
                    QuestionTxt(survey.questions[6], 9, commodityList);
                    
                    Answer = document.createElement("span");
                    
                    if(isCommodityCharge[currentIndex])
                    {
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No" />'+
                        '<label for = "NoCommodityCharge">No</label>';
                        commodityList.appendChild(Answer);
                        getCommodityChargeInfo();
                    }
                    else
                    {  
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" />'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoCommodityCharge">No</label>';
                        commodityList.appendChild(Answer);
                    }
                    
                    var ButtonDiv = document.createElement("div");
                    ButtonDiv.style.marginTop = "15px";
                    form.appendChild(ButtonDiv);
                    
                    
                    var Button = document.createElement("span");
                    if(currentIndex == SelectedRateStructures.length - 1)
                    {
                        Button.innerHTML = '<button type = "button" style = "margin-right: 10px" onclick = "PreviousGetAnswers()">Previous</button>' + 
                        '<button type = "button" onclick = "NextGetAnswers()">Complete</button>';
                    }
                    else
                    {
                        Button.innerHTML = '<button type = "button" style = "margin-right: 10px" onclick = "PreviousGetAnswers()">Previous</button>' + 
                        '<button type = "button" onclick = "NextGetAnswers()">Next</button>';
                    }
                    ButtonDiv.appendChild(Button);
                }
                
                
                
                
                
                function getServiceChargeInfo()
                {
                    var RadioButton = document.getElementById("YesServiceCharge");
                    
                    isServiceCharge[currentIndex] = RadioButton.checked;
                    
                    if(RadioButton.checked == true)
                    {
                        QuestionTxt(survey.questions[5], 6, serviceList);
                        
                        Answer = document.createElement("span");
                        Answer.innerHTML = "";
                        
                        for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                        {
                            var checkboxID = "dependsOn" + i;
                            Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "getServiceChargeDepends()" value ="' + survey.serviceDependsOn[i]+ '"/>'+
                            '<label for = checkboxID>' + survey.serviceDependsOn[i] + '</label>';
                        }
                        
                        serviceList.appendChild(Answer);
                        
                        var serviceDependsOnDiv = document.createElement("div");
                        serviceDependsOnDiv.id = "serviceDependsOnDiv";
                        serviceList.appendChild(serviceDependsOnDiv);
                        
                        if(serviceParameters[currentIndex] != null)
                        {
                            for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                            {
                                var isChecked = document.getElementById("dependsOn" + i);
                                for(var j = 0; j < serviceParameters[currentIndex].length; ++j)
                                {
                                    if(serviceParameters[currentIndex][j] == isChecked.value)
                                    {
                                        isChecked.checked = true;
                                    }
                                }
                            }
                            
                            getServiceChargeDepends();
                        }
                    }
                    else
                    {
                        clear(serviceList);
                        serviceParameters[currentIndex] = [];
                        
                        QuestionTxt(survey.questions[4], 5, serviceList);
                        
                        Answer = document.createElement("span");
                    
                        Answer.innerHTML = '<input type = "radio" id = "YesServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "Yes"/>'+
                        '<label for = "YesServiceCharge">Yes</label>'+
                        '<input type = "radio" id = "NoServiceCharge" name = "isServiceCharge" onclick = "getServiceChargeInfo()" value = "No" checked = "true"/>'+
                        '<label for = "NoServiceCharge">No</label>';
                    
                        serviceList.appendChild(Answer);
                    }
                }
                
                function getCommodityChargeInfo()
                {
                    var RadioButton = document.getElementById("YesCommodityCharge");
                    
                    isCommodityCharge[currentIndex] = RadioButton.checked;
                    
                    if(RadioButton.checked == true)
                    {
                        QuestionTxt(survey.questions[7], 10, commodityList);
                        
                        Answer = document.createElement("span");
                        Answer.innerHTML = '<input type = "radio" id = "Uniform" name = "CommodityStructure" onclick = "UniformDepends()" value = "Uniform"/>'+
                        '<label for = "Uniform">Uniform</label>'+
                        '<input type = "radio" id = "Tiered" name = "CommodityStructure" onclick = "TieredDepends()" value = "Tiered"/>'+
                        '<label for = "Tiered">Tiered</label>'+
                        '<input type = "radio" id = "Budget" name = "CommodityStructure" onclick = "BudgetDepends()" value = "Budget"/>'+
                        '<label for = "Uniform">Budget</label>';
                        
                        commodityList.appendChild(Answer);
                        
                        var commodityDependsOnDiv = document.createElement("div");
                        commodityDependsOnDiv.id = "commodityDependsOnDiv";
                        commodityList.appendChild(commodityDependsOnDiv);
                    }
                    else
                    {
                        clear(commodityList);
                        commodityStructure[currentIndex] = [];
                        
                        QuestionTxt(survey.questions[6], 9, commodityList);
                        
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "YesCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "Yes" />'+
                        '<label for = "YesCommodityCharge">Yes</label>'+
                        '<input type = "radio" id = "NoCommodityCharge" name = "isCommodityCharge" onclick = "getCommodityChargeInfo()" value = "No"  checked = "true"/>'+
                        '<label for = "NoCommodityCharge">No</label>';
                        
                        commodityList.appendChild(Answer);
                    }
                    
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        var Radio = document.getElementById("Uniform");
                        Radio.checked = true;
                        
                        UniformDepends();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered')
                    {
                        var Radio = document.getElementById("Tiered");
                        Radio.checked = true;
                        
                        TieredDepends();
                    }
                    else if(commodityStructure[currentIndex] == 'Budget')
                    {
                        var Radio = document.getElementById("Budget");
                        Radio.checked = true;
                        
                        BudgetDepends();
                    }
                }
                
                
                
                function getServiceChargeDepends()
                {
                    serviceParameters[currentIndex] = [];
                    
                    for(var i = 0; i < survey.serviceDependsOn.length; ++i)
                    {
                        var tempID = "dependsOn" + i + "";
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox.checked == true)
                        {
                            serviceParameters[currentIndex].push(survey.serviceDependsOn[i]);
                        }
                        else
                        {
                            if(survey.serviceDependsOn[i] == "Meter Type")
                            {
                                meterTypes[currentIndex] = null;
                            }
                            else if(survey.serviceDependsOn[i] == "Meter Size")
                            {
                                meterSizes[currentIndex] = null;
                            }
                        }
                    }
                    
                    var serviceDependsOnDiv = document.getElementById("serviceDependsOnDiv");
                    
                    if(serviceDependsOnDiv.childNodes.length > 0)
                    {
                        clear(serviceDependsOnDiv);
                    }
                    
                    for(var i = 0; i < serviceParameters[currentIndex].length; ++i)
                    {
                        text = "Select The " + serviceParameters[currentIndex][i] + "s to include:";
                        
                        if(serviceParameters[currentIndex][i] == "Meter Size")
                        {
                            QuestionTxt(text, 6, serviceDependsOnDiv);
                            
                            Answer = document.createElement("span");
                            Answer.innerHTML = "";
                            
                            for(var j = 0; j  < survey.meterSizes.length; ++j)
                            {
                                var checkboxID = "meterSize" + j;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "createServiceChargeField()" value ="' + survey.meterSizes[j] + '"/>'+
                                '<label for = checkboxID>' + survey.meterSizes[j] + '"</label></br>';
                            }
                            serviceDependsOnDiv.appendChild(Answer);
                        }
                        else
                        {
                            QuestionTxt(text, 7, serviceDependsOnDiv);
                            
                            Answer = document.createElement("span");
                            Answer.innerHTML = "";
                             for(var j = 0; j  < survey.meterTypes.length; ++j)
                            {
                                var checkboxID = "meterType" + j;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "ServiceDependsOn" onclick = "createServiceChargeField()" value ="' + survey.meterTypes[j] + '"/>'+
                                '<label for = checkboxID>' + survey.meterTypes[j] + '</label></br>';
                            }
                            serviceDependsOnDiv.appendChild(Answer);
                        }
                    }
                    
                    Answer = document.createElement("div");
                    Answer.id = "serviceChargesDiv";
                    serviceDependsOnDiv.appendChild(Answer);
                    
                    if(meterSizes[currentIndex] != null)
                    {
                        for(var i = 0; i < survey.meterSizes.length; ++i)
                        {
                            var isChecked = document.getElementById("meterSize" + i);
                            
                            for(var j = 0; j < meterSizes[currentIndex].length; ++j)
                            {
                                if(meterSizes[currentIndex][j] ==isChecked.value)
                                {
                                    isChecked.checked = true;
                                }
                            }
                        }
                    }
                    
                    if(meterTypes[currentIndex] != null)
                    {
                        for(var i = 0; i < survey.meterTypes.length; ++i)
                        {
                            var isChecked = document.getElementById("meterType" + i);
                            
                            for(var j = 0; j < meterTypes[currentIndex].length; ++j)
                            {
                                if(meterTypes[currentIndex][j] ==isChecked.value)
                                {
                                    isChecked.checked = true;
                                }
                            }
                        }
                    }
                    
                    if(meterTypes[currentIndex] != null || meterSizes[currentIndex] != null)
                    {
                        createServiceChargeField();
                    }
                }
                
                function primeParamArrays()
                {
                    if(season[currentIndex] == null)
                        season[currentIndex] = [];
                    if(temperatureZone[currentIndex] == null)
                        temperatureZone[currentIndex] = [];
                    if(elevationZone[currentIndex] == null)
                        elevationZone[currentIndex] = []; 
                    if(pressureZone[currentIndex] == null)
                        pressureZone[currentIndex] = [];
                    if(lotSizeGroup[currentIndex] == null)
                        lotSizeGroup[currentIndex] = [];
                    if(month[currentIndex] == null)
                        month[currentIndex] = [];
                    if(commodityMeterSize[currentIndex] == null)
                        commodityMeterSize[currentIndex] = [];
                }
                
                function UniformDepends()
                {
                    commodityStructure[currentIndex] = 'Uniform';
                    
                    primeParamArrays();
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt(survey.questions[8], 11, commodityDependsOnDiv);
                    
                    Answer = document.createElement("span");
                        
                    Answer.innerHTML = '<input type = "radio" id = "YesUniformDepends" name = "isUniformDependsOn" onclick = "getDepends(uniformParametersDiv, uniformParameters[currentIndex], \'uniform\')" value = "Yes" />'+
                    '<label for = "YesUniformDepends">Yes</label>'+
                    '<input type = "radio" id = "NoUniformDepends" name = "isUniformDependsOn" onclick = "getUniformRate()" value = "No"/>'+
                    '<label for = "NoCommodityCharge">No</label>';
                        
                    commodityDependsOnDiv.appendChild(Answer);
                    
                    var uniformParametersDiv = document.createElement("div");
                    uniformParametersDiv.id = "uniformParametersDiv";
                    commodityDependsOnDiv.appendChild(uniformParametersDiv);
                    
                    var uniformParametersValueDiv = document.createElement("div");
                    uniformParametersValueDiv.id = "uniformParametersValueDiv";
                    commodityDependsOnDiv.appendChild(uniformParametersValueDiv);
                    
                    var uniformPriceDiv = document.createElement("div");
                    uniformPriceDiv.id = "uniformPriceDiv";
                    commodityDependsOnDiv.appendChild(uniformPriceDiv);
                    
                    if(isUniformDependsOn[currentIndex] == 'Yes')
                    {
                        var Radio = document.getElementById("YesUniformDepends");
                        Radio.checked = true;
                        getDepends(uniformParametersDiv, uniformParameters[currentIndex], "uniform");
                    }
                    else if(isUniformDependsOn[currentIndex] == 'No')
                    {
                        var Radio = document.getElementById("NoUniformDepends");
                        Radio.checked = true;
                        getUniformRate();
                    }
                }
                
                function getUniformRate()
                {
                    var Radio = document.getElementById("NoUniformDepends");
                    
                    if(uniformPriceDiv.childNodes.length > 0)
                    {
                        clear(uniformPriceDiv);
                    }
                    
                    if(Radio.checked)
                    {
                        isUniformDependsOn[currentIndex] = 'No';
                        
                        var uniformParametersDiv = document.getElementById("uniformParametersDiv");
                        if(uniformParametersDiv.childNodes.length > 0)
                        {
                            clear(uniformParametersDiv);
                        }
                        if(uniformParametersValueDiv.childNodes.length > 0)
                        {
                            clear(uniformParametersValueDiv);
                        }
                    }
                    else
                    {
                        isUniformDependsOn[currentIndex] = 'Yes';
                    }
                    
                    if(isUniformDependsOn[currentIndex] == 'Yes')
                    {
                        createUsedParameters(uniformParameters[currentIndex], 0);
                        
                            var Continue = true;
                            
                            for(var i = 0; i < ParametersToUse.length; ++i)
                            {
                                if(ParametersToUse[i] == null)
                                {
                                    Continue = false;
                                    i = ParametersToUse.length;
                                }
                            }
                            
                            if(Continue && ParametersToUse.length > 0)
                            {
                                QuestionTxt("Enter The Cost Per CCF:", 12, uniformPriceDiv)
                                commodityChargeCategories[currentIndex] = [];
                                getCategories(commodityChargeCategories[currentIndex], 0, ParametersToUse.length, "", "Rate:");
                            
                        
                                for(var i = 0; i < commodityChargeCategories[currentIndex].length; ++i)
                                {
                                    Answer = document.createElement("label");
                                    Answer.setAttribute("for", "commodityCharge" + i);
                                    Answer.setAttribute("style", "float: left; width: 250px;");
                                    Answer.appendChild(document.createTextNode(commodityChargeCategories[currentIndex][i]));
                                    uniformPriceDiv.appendChild(Answer);
                                
                                    Answer = document.createElement("input");
                                    Answer.setAttribute("type", "text");
                                    Answer.id = "commodityCharge" + i;
                                    uniformPriceDiv.appendChild(Answer);
                                
                                    var BREAK = document.createElement("br");
                                    uniformPriceDiv.appendChild(BREAK);
                                }
                            
                                if(commodityCharges[currentIndex] != null && commodityChargeCategories[currentIndex] != null)
                                {
                                    if(commodityCharges[currentIndex].length == commodityChargeCategories[currentIndex].length)
                                    {
                                        for(var i = 0; i < commodityCharges[currentIndex].length; ++i)
                                        {
                                            var input = document.getElementById("commodityCharge" + i);
                                            input.value = commodityCharges[currentIndex][i];
                                        }
                                    }
                                }
                            }
                    }
                    else if(isUniformDependsOn[currentIndex] == 'No')
                    {
                        QuestionTxt("Enter The Cost Per CCF:", 12, uniformPriceDiv);
                        
                        var label = document.createElement("label");
                        label.setAttribute("for","uniformPrice0");
                        Answer.setAttribute("style", "float: left; width: 150px;");
                        label.innerHTML = "Rate: ";
                        uniformPriceDiv.appendChild(label);
                        
                        Answer = document.createElement("input");
                        Answer.setAttribute("type", "text");
                        Answer.id = "uniformPrice0";
                        uniformPriceDiv.appendChild(Answer);
                    }
                }
                
                function TieredDepends()
                {
                    commodityStructure[currentIndex] = 'Tiered';
                    
                    primeParamArrays();
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt(survey.questions[9], 11, commodityDependsOnDiv);
                    Answer = document.createElement("select");
                    for(var i = 2; i <= 6; ++i)
                    {
                        Answer.appendChild(new Option(i, i));
                    }
                    Answer.id = "numOfTiers";
                    if(tierLevels[currentIndex] != null)
                    {
                        Answer.value = tierLevels[currentIndex];
                    }
                    Answer.setAttribute("onchange", "createTierLevels()");
                    commodityDependsOnDiv.appendChild(Answer);
                    
                    var tierStartsDiv = document.createElement("div");
                    tierStartsDiv.id = "tierStartsDiv";
                    commodityDependsOnDiv.appendChild(tierStartsDiv);
                    
                    var tierPricesDiv = document.createElement("div");
                    tierPricesDiv.id = "tierPricesDiv";
                    commodityDependsOnDiv.appendChild(tierPricesDiv);
                    
                    createTierLevels();
                }
                
                function createTierLevels()
                {
                    var tiers = document.getElementById("numOfTiers");
                    tierLevels[currentIndex] = tiers.value;
                    
                    Tier("tierStartsDiv", survey.questions[10], 14, isTierStartsDepends[currentIndex], "TierStarts", getTierStartsInfo);
                    Tier("tierPricesDiv", survey.questions[12], 15, isTierPricesDepends[currentIndex], "TierPrices", getTierPricesInfo);
                    getTierStartsInfo();
                    getTierPricesInfo();
                }
                
                function Tier(DIV, question, qNumber, dependsOn, Identifier, Function)
                {
                    var tierDiv = document.getElementById(DIV);
                    if(tierDiv.childNodes.length > 0)
                    {
                        clear(tierDiv);
                    }
                    QuestionTxt(question, qNumber, tierDiv);
                    
                    if(dependsOn)
                    {
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "Yes' + Identifier + '" name = "is' + Identifier + 'Depends" onclick = "get' + Identifier + 'Info()" value = "Yes" checked = "true"/>'+
                        '<label for = "Yes' + Identifier + '">Yes</label>'+
                        '<input type = "radio" id = "No' + Identifier + '" name = "is' + Identifier + 'Depends" onclick = "get' + Identifier + 'Info()" value = "No" />'+
                        '<label for = "No' + Identifier + '">No</label>';
                        
                        tierDiv.appendChild(Answer);
                        
                        Function();
                    }
                    else
                    {
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "Yes' + Identifier + '" name = "is' + Identifier + 'Depends" onclick = "get' + Identifier + 'Info()" value = "Yes"/>'+
                        '<label for = "Yes' + Identifier + '">Yes</label>'+
                        '<input type = "radio" id = "No' + Identifier + '" name = "is' + Identifier + 'Depends" onclick = "get' + Identifier + 'Info()" value = "No" checked = "true"/>'+
                        '<label for = "No' + Identifier + '">No</label>';
                        
                        tierDiv.appendChild(Answer);
                    }
                }
                
                function getTierStartsInfo()
                {
                    var Radio = document.getElementById("YesTierStarts");
                    
                    if(Radio.checked)
                    {
                        isTierStartsDepends[currentIndex] = true;
                        if(tierStartsDiv.childNodes.length > 0)
                        {
                            clear(tierStartsDiv);
                        }
                        QuestionTxt(survey.questions[10], 14,tierStartsDiv)
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "YesTierStarts" name = "isTierStartsDepends" onclick = "getTierStartsInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesTierStarts">Yes</label>'+
                        '<input type = "radio" id = "NoTierStarts" name = "isTierStartsDepends" onclick = "getTierStartsInfo()" value = "No" />'+
                        '<label for = "NoTierStarts">No</label>';
                        
                        tierStartsDiv.appendChild(Answer);
                        
                        var tierStartsParameterDiv = document.createElement("div");
                        tierStartsParameterDiv.id = "tierStartsParameterDiv";
                        tierStartsDiv.appendChild(tierStartsParameterDiv);
                        
                        var tierStartsParameterValueDiv = document.createElement("div");
                        tierStartsParameterValueDiv.id = "tierStartsParameterValueDiv";
                        tierStartsDiv.appendChild(tierStartsParameterValueDiv);
                        
                        var tierStartsValuesDiv = document.createElement("div");
                        tierStartsValuesDiv.id = "tierStartsValuesDiv";
                        tierStartsDiv.appendChild(tierStartsValuesDiv);
                        
                        getDepends(tierStartsParameterDiv, tierStartsParameters[currentIndex], 'tierStarts');
                    }
                    else
                    {
                        isTierStartsDepends[currentIndex] = false;
                        Tier("tierStartsDiv", survey.questions[10], 14, isTierStartsDepends[currentIndex], "TierStarts", getTierStartsInfo);
                        
                        Answer = document.createElement('div');
                        Answer.id = "tierStartsValuesDIV";
                        tierStartsDiv.appendChild(Answer);
                        
                        tierStartsCategories[currentIndex] = [""];
                        
                        createTierFields(Answer, "tierStarts", tierStartsCategories[currentIndex], "Tier Levels:")
                    }
                }
                
                function getTierPricesInfo()
                {
                    var Radio = document.getElementById("YesTierPrices");
                    
                    if(Radio.checked)
                    {
                        isTierPricesDepends[currentIndex] = true;
                        if(tierPricesDiv.childNodes.length > 0)
                        {
                            clear(tierPricesDiv);
                        }
                        QuestionTxt(survey.questions[12], 15,tierPricesDiv)
                        Answer = document.createElement("span");
                        
                        Answer.innerHTML = '<input type = "radio" id = "YesTierPrices" name = "isTierPricesDepends" onclick = "getTierPricesInfo()" value = "Yes" checked = "true"/>'+
                        '<label for = "YesTierPrices">Yes</label>'+
                        '<input type = "radio" id = "NoTierPrices" name = "isTierPricesDepends" onclick = "getTierPricesInfo()" value = "No" />'+
                        '<label for = "NoTierPrices">No</label>';
                        
                        tierPricesDiv.appendChild(Answer);
                        
                        var tierPricesParameterDiv = document.createElement("div");
                        tierPricesParameterDiv.id = "tierPricesParameterDiv";
                        tierPricesDiv.appendChild(tierPricesParameterDiv);
                        
                        var tierPricesParameterValueDiv = document.createElement("div");
                        tierPricesParameterValueDiv.id = "tierPricesParameterValueDiv";
                        tierPricesDiv.appendChild(tierPricesParameterValueDiv);
                        
                        var tierPricesValuesDiv = document.createElement("div");
                        tierPricesValuesDiv.id = "tierPricesValuesDiv";
                        tierPricesDiv.appendChild(tierPricesValuesDiv);
                        
                        getDepends(tierPricesParameterDiv, tierPricesParameters[currentIndex], 'tierPrices');
                    }
                    else
                    {
                        isTierPricesDepends[currentIndex] = false;
                        Tier("tierPricesDiv", survey.questions[12], 15, isTierPricesDepends[currentIndex], "TierPrices", getTierPricesInfo);
                        
                        Answer = document.createElement('div');
                        Answer.id = "tierPricesValuesDIV";
                        tierPricesDiv.appendChild(Answer);
                        
                        commodityChargeCategories[currentIndex] = [""];
                        
                        createTierFields(Answer, "tierPrices", commodityChargeCategories[currentIndex], "Tier Prices:")
                    }
                }
                
                function budgetVariableFieldCreator(DIV, id, Text, valueArray, defaultValue)
                {
                    Answer = document.createElement("label");
                    Answer.setAttribute("for", id);
                    Answer.setAttribute("style", "float: left; width: 250px;");
                    Answer.appendChild(document.createTextNode(Text));
                    DIV.appendChild(Answer);
                    
                    Answer = document.createElement("input");
                    Answer.setAttribute("type", "text");
                    Answer.style.width = '300px';
                    Answer.id = id;
                    if(valueArray != null)
                    {
                        Answer.value = valueArray;
                    }
                    else
                    {
                        Answer.value = defaultValue;
                    }
                    DIV.appendChild(Answer);
                    
                    var BREAK = document.createElement("br");
                    DIV.appendChild(BREAK);
                }
                
                function BudgetDepends()
                {
                    commodityStructure[currentIndex] = 'Budget';
                    primeParamArrays();
                    
                    var commodityDependsOnDiv = document.getElementById("commodityDependsOnDiv");
                    if(commodityDependsOnDiv.childNodes.length > 0)
                    {
                        clear(commodityDependsOnDiv);
                    }
                    
                    QuestionTxt("Enter the Values Below:", 17, commodityDependsOnDiv);
                    
                    
                    budgetVariableFieldCreator(commodityDependsOnDiv, "gpcd", "Gallons Per Capita Day:", gpcd[currentIndex], "60");
                    budgetVariableFieldCreator(commodityDependsOnDiv, "indoor", "Indoor Budget Equation:", indoor[currentIndex], "hhsize*gpcd*days_in_period*(1/178)");
                    budgetVariableFieldCreator(commodityDependsOnDiv, "outdoor", "Outdoor Budget Equation:", gpcd[currentIndex], "landscape_factor*et_amount*irr_area*0.62*(1/748)");
                    
                    
                    QuestionTxt(survey.questions[9], 11, commodityDependsOnDiv);
                    Answer = document.createElement("select");
                    for(var i = 4; i <= 6; ++i)
                    {
                        Answer.appendChild(new Option(i, i));
                    }
                    Answer.id = "numOfTiers";
                    if(tierLevels[currentIndex] != null)
                    {
                        if(tierLevels[currentIndex] < 4)
                        {
                            Answer.value = 4;
                        }
                        else
                        {
                            Answer.value = tierLevels[currentIndex];
                        }
                    }
                    Answer.setAttribute("onchange", "createTierLevels()");
                    commodityDependsOnDiv.appendChild(Answer);
                    
                    var tierStartsDiv = document.createElement("div");
                    tierStartsDiv.id = "tierStartsDiv";
                    commodityDependsOnDiv.appendChild(tierStartsDiv);
                    
                    var tierPricesDiv = document.createElement("div");
                    tierPricesDiv.id = "tierPricesDiv";
                    commodityDependsOnDiv.appendChild(tierPricesDiv);
                    
                    createTierLevels();
                }
                
                
                function getDepends(DIV, identifier, Structure)
                {
                    if(DIV.childNodes.length > 0)
                    {
                        clear(DIV);
                    }
                    QuestionTxt(survey.questions[11] ,13, DIV);
                    
                    Answer = document.createElement("span");
                    for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                    {
                        var checkboxID = Structure + "DependsOn" + i;
                            Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "CommodityDependsOn" onclick = "storeCommodityDepends(\'' + Structure + '\')" value ="' + survey.commodityDependsOn[i]+ '"/>'+
                            '<label for = "' + checkboxID + '">' + survey.commodityDependsOn[i] + '</label><br/>';
                    }
                    DIV.appendChild(Answer);
                    
                    if(identifier != null)
                    {
                        for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                        {
                            var checkCheckBox = document.getElementById(Structure + "DependsOn" + i)
                            for(var j = 0; j < identifier.length; ++j)
                            {
                                if(identifier[j] == checkCheckBox.value)
                                {
                                    checkCheckBox.checked = true;
                                }
                            }
                        }
                        storeCommodityDepends(Structure);
                    }
                    
                }
                
                function storeCommodityDepends(tierIdentifier)
                {
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        uniformParameters[currentIndex] = [];
                        pushParameters(uniformParameters[currentIndex], 'uniform');
                        
                        if(uniformParametersValueDiv.childNodes.length >  0)
                        {
                            clear(uniformParametersValueDiv);
                        }
                        
                        for(var i = 0; i < uniformParameters[currentIndex].length; ++i)
                        {
                            getParameterValues(uniformParameters[currentIndex][i], uniformParametersValueDiv, 'Uniform', 0);
                        }
                        clearParametersNotUsed(uniformParameters[currentIndex], 0);
                        commodityChargeCategories[currentIndex] = null;
                        getUniformRate();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered' || commodityStructure[currentIndex] == 'Budget')
                    {
                        if(tierIdentifier == "tierStarts")
                        {
                            tierStartsParameters[currentIndex] = [];
                            pushParameters(tierStartsParameters[currentIndex], tierIdentifier);
                            
                            var tierStartsParameterValueDiv = document.getElementById("tierStartsParameterValueDiv");
                            if(tierStartsParameterValueDiv.childNodes.length > 0)
                            {
                                clear(tierStartsParameterValueDiv);
                            }
                            
                            clearParametersNotUsed(tierStartsParameters[currentIndex], 1);
                            tierStartsCategories[currentIndex] = null;
                            
                            for(value in tierStartsParameters[currentIndex])
                            {
                                getParameterValues(tierStartsParameters[currentIndex][value], tierStartsParameterValueDiv, 'tierStarts', 1);
                            }
                            pushParameterValues('tierStarts');
                        }
                        else
                        {
                            tierPricesParameters[currentIndex] = [];
                            pushParameters(tierPricesParameters[currentIndex], tierIdentifier);
                            
                            var tierPricesParameterValueDiv = document.getElementById("tierPricesParameterValueDiv");
                            if(tierPricesParameterValueDiv.childNodes.length > 0)
                            {
                                clear(tierPricesParameterValueDiv);
                            }
                            
                            clearParametersNotUsed(tierPricesParameters[currentIndex], 2);
                            commodityChargeCategories[currentIndex] = null;
                            
                            for(value in tierPricesParameters[currentIndex])
                            {
                                getParameterValues(tierPricesParameters[currentIndex][value], tierPricesParameterValueDiv, 'tierPrices', 2);
                            }
                            pushParameterValues('tierPrices');
                        }
                    }
                }
                
                function pushParameters(STRUCTURE, identifier)
                {
                    for(var i = 0; i < survey.commodityDependsOn.length; ++i)
                    {
                        var checkCheckBox = document.getElementById(identifier + "DependsOn" + i);
                        
                        if(checkCheckBox.checked)
                        {
                            STRUCTURE.push(checkCheckBox.value);
                        }
                    }
                }
                
                function getParameterValues(parameter, DIV, identifier, tierIdentifier)
                {
                    QuestionTxt("Select the values for " + parameter ,13 , DIV)
                    
                    Answer = document.createElement("span");
                    
                    switch(parameter)
                    {
                        case 'Season': 
                            for(var i = 0; i < survey.season.length; ++i)
                            {   
                                var checkboxID = identifier + "Season" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'SeasonValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="' + survey.season[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.season[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(season[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.season.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "Season" + i);
                                        for(var j = 0; j < season[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(season[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Meter Size': 
                            for(var i = 0; i < survey.meterSizes.length; ++i)
                            {   
                                var checkboxID = identifier + "MeterSize" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'MeterSizeValues" onclick = "pushParameterValues(\''+ identifier +'\')" value =\'' + survey.meterSizes[i] + '"\'/>'+
                                '<label for = "' + checkboxID + '">' + survey.meterSizes[i] + '"</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(commodityMeterSize[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.meterSizes.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "MeterSize" + i);
                                        for(var j = 0; j < commodityMeterSize[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(commodityMeterSize[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Month': 
                            for(var i = 0; i < survey.month.length; ++i)
                            {   
                                var checkboxID = identifier + "Month" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'SeasonValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="' + survey.month[i] + '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.month[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(month[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.month.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "Month" + i);
                                        for(var j = 0; j < month[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(month[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Temperature Zone':
                            for(var i = 0; i < survey.temperatureZone.length; ++i)
                            {   
                                var checkboxID = identifier + "TemperatureZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'TemperatureZoneValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="' + survey.temperatureZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.temperatureZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(temperatureZone[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.temperatureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "TemperatureZone" + i);
                                        for(var j = 0; j < temperatureZone[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(temperatureZone[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Elevation Zone':
                            for(var i = 0; i < survey.elevationZone.length; ++i)
                            {   
                                var checkboxID = identifier + "ElevationZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'ElevationZoneValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="Elevation ' + survey.elevationZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.elevationZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(elevationZone[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.elevationZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "ElevationZone" + i);
                                        for(var j = 0; j < elevationZone[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(elevationZone[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Pressure Zone':
                            for(var i = 0; i < survey.pressureZone.length; ++i)
                            {   
                                var checkboxID = identifier + "PressureZone" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'PressureZoneValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="Pressure ' + survey.pressureZone[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.pressureZone[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(pressureZone[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.pressureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "PressureZone" + i);
                                        for(var j = 0; j < pressureZone[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(pressureZone[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                        case 'Lot Size Group':
                            for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                            {   
                                var checkboxID = identifier + "LotSizeGroup" + i;
                                Answer.innerHTML += '<input type = "checkbox" id = "' + checkboxID + '" name = "' + identifier + 'LotSizeGroupValues" onclick = "pushParameterValues(\''+ identifier +'\')" value ="Lot Size ' + survey.lotSizeGroup[i]+ '"/>'+
                                '<label for = "' + checkboxID + '">' + survey.lotSizeGroup[i] + '</label><br/>';
                            }
                            DIV.appendChild(Answer);
                            if(lotSizeGroup[currentIndex][tierIdentifier] != null)
                            {
                                    for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(identifier + "LotSizeGroup" + i);
                                        for(var j = 0; j < lotSizeGroup[currentIndex][tierIdentifier].length; ++j)
                                        {
                                            if(lotSizeGroup[currentIndex][tierIdentifier][j] == checkCheckBox.value)
                                            {
                                                checkCheckBox.checked = true;
                                            }
                                        }
                                    }
                            }
                            break;
                    }
                }
                
                function clearParametersNotUsed(Structure, tierIdentifier)
                {
                    for(value in survey.commodityDependsOn)
                    {
                        if(jQuery.inArray(survey.commodityDependsOn[value], Structure) == -1)
                        {
                            switch(survey.commodityDependsOn[value])
                            {
                                case 'Season': season[currentIndex][tierIdentifier] = []; break;
                                case 'Meter Size': commodityMeterSize[currentIndex][tierIdentifier] = []; break;
                                case 'Month': month[currentIndex][tierIdentifier] = []; break;
                                case 'Temperature Zone': temperatureZone[currentIndex][tierIdentifier] = []; break;
                                case 'Lot Size Group': lotSizeGroup[currentIndex][tierIdentifier] = []; break;
                                case 'Pressure Zone': pressureZone[currentIndex][tierIdentifier] = []; break;
                                case 'Elevation Zone': elevationZone[currentIndex][tierIdentifier] = []; break;
                            }
                        }
                    }
                }
                
                function pushParameterValues(Identifier)
                {
                    if(commodityStructure[currentIndex] == 'Uniform')
                    {
                        theSwitchStatement(uniformParameters[currentIndex], Identifier, 0);
                        getUniformRate();
                    }
                    else if(commodityStructure[currentIndex] == 'Tiered' || commodityStructure[currentIndex] == 'Budget')
                    {
                        if(Identifier == "tierStarts")
                        {
                            var Continue = true;
                            theSwitchStatement(tierStartsParameters[currentIndex], Identifier, 1);
                            createUsedParameters(tierStartsParameters[currentIndex], 1);
                            for(var i = 0; i < ParametersToUse.length; ++i)
                            {
                                if(ParametersToUse[i] == null)
                                {
                                    Continue = false;
                                    i = ParametersToUse.length;
                                }
                            }
                            
                            if(Continue)
                            {
                                tierStartsCategories[currentIndex] = [];
                                getCategories(tierStartsCategories[currentIndex], 0, ParametersToUse.length, "", "Level:");
                            }
                            
                            var tierStartsValuesDiv = document.getElementById("tierStartsValuesDiv");
                            
                            createTierFields(tierStartsValuesDiv, "tierStarts", tierStartsCategories[currentIndex], "Tier Levels");
                        }
                        else
                        {
                            var Continue = true;
                            theSwitchStatement(tierPricesParameters[currentIndex], Identifier, 2);
                            createUsedParameters(tierPricesParameters[currentIndex], 2);
                            for(var i = 0; i < ParametersToUse.length; ++i)
                            {
                                if(ParametersToUse[i] == null)
                                {
                                    Continue = false;
                                    i = ParametersToUse.length;
                                }
                            }
                            
                            if(Continue)
                            {
                                commodityChargeCategories[currentIndex] = [];
                                getCategories(commodityChargeCategories[currentIndex], 0, ParametersToUse.length, "", "Rate:");
                            }
                            
                            var tierPricesValuesDiv = document.getElementById("tierPricesValuesDiv");
                            
                            createTierFields(tierPricesValuesDiv, "tierPrices", commodityChargeCategories[currentIndex], "Tier Prices");
                        }
                    }
                }
                
                function theSwitchStatement(theArray, Identifier, tierIdentifier)
                {
                    for(var j = 0; j < theArray.length; ++j)
                        {
                            switch(theArray[j])
                            {
                                case 'Season': 
                                    season[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.season.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "Season" + i);
                                        if(checkCheckBox.checked)
                                        { 
                                            season[currentIndex][tierIdentifier].push(checkCheckBox.value); 
                                        }
                                    } break;
                                case 'Meter Size': 
                                    commodityMeterSize[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.meterSizes.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "MeterSize" + i);
                                        if(checkCheckBox.checked)
                                        { 
                                            commodityMeterSize[currentIndex][tierIdentifier].push(checkCheckBox.value); 
                                        }
                                    } break;
                                case 'Month': 
                                    month[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.month.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "Month" + i);
                                        if(checkCheckBox.checked)
                                        { 
                                            month[currentIndex][tierIdentifier].push(checkCheckBox.value); 
                                        }
                                    } break;
                                case 'Temperature Zone':
                                    temperatureZone[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.temperatureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "TemperatureZone" + i);
                                        if(checkCheckBox.checked)
                                        { temperatureZone[currentIndex][tierIdentifier].push(checkCheckBox.value); }
                                    } break;
                                case 'Pressure Zone':
                                    pressureZone[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.pressureZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "PressureZone" + i);
                                        if(checkCheckBox.checked)
                                        { pressureZone[currentIndex][tierIdentifier].push(checkCheckBox.value); }
                                    } break;
                                case 'Elevation Zone':
                                    elevationZone[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.elevationZone.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "ElevationZone" + i);
                                        if(checkCheckBox.checked)
                                        { elevationZone[currentIndex][tierIdentifier].push(checkCheckBox.value); }
                                    } break;
                                case 'Lot Size Group':
                                    lotSizeGroup[currentIndex][tierIdentifier] = [];
                                    for(var i = 0; i < survey.lotSizeGroup.length; ++i)
                                    {
                                        var checkCheckBox = document.getElementById(Identifier + "LotSizeGroup" + i);
                                        if(checkCheckBox.checked)
                                        { lotSizeGroup[currentIndex][tierIdentifier].push(checkCheckBox.value); }
                                    } break;
                            }
                        }
                }
                
                function getCategories(actualArray, Position, Stop, Text, EndText)
                {
                    if(Position == Stop)
                    {
                        actualArray.push(Text + EndText);
                    }
                    else
                    {
                        for(var i = 0; i < ParametersToUse[Position].length; ++i)
                        {
                            Temp = Text;
                            Temp += ParametersToUse[Position][i] + " ";
                            getCategories(actualArray, Position + 1, Stop, Temp, EndText);
                        }
                    }
                }
                
                function createUsedParameters(parameterList, identifier)
                {
                    ParametersToUse = [];
                        
                    for(var i = 0; i < parameterList.length; ++i)
                    {
                        if(season[currentIndex] != null || commodityMeterSize[currentIndex] != null || month[currentIndex] != null || temperatureZone[currentIndex] != null || elevationZone[currentIndex] != null || pressureZone[currentIndex] != null || lotSizeGroup[currentIndex] != null )
                        {
                            switch(parameterList[i])
                            {
                                case 'Season': ParametersToUse[i] = season[currentIndex][identifier]; break;
                                case 'Meter Size': ParametersToUse[i] = commodityMeterSize[currentIndex][identifier]; break;
                                case 'Month': ParametersToUse[i] = month[currentIndex][identifier]; break;
                                case 'Temperature Zone': ParametersToUse[i] = temperatureZone[currentIndex][identifier]; break;
                                case 'Elevation Zone': ParametersToUse[i] = elevationZone[currentIndex][identifier]; break;
                                case 'Pressure Zone': ParametersToUse[i] = pressureZone[currentIndex][identifier]; break;
                                case 'Lot Size Group': ParametersToUse[i] = lotSizeGroup[currentIndex][identifier]; break;
                            }
                        }
                    }
                }
                
                function createTierFields(DIV, identifier, categoryArray, subtitle)
                {
                    if(DIV.childNodes.length > 0)
                    {
                        clear(DIV);
                    }
                    
                    if(commodityCharges[currentIndex] != null && commodityCharges[currentIndex].length != 0)
                    {
                        if(commodityCharges[currentIndex].length != commodityChargeCategories[currentIndex].length*tierLevels[currentIndex])
                            commodityCharges[currentIndex] = [];
                    }
                    if(tierStartsValues[currentIndex] != null)
                    {
                        if(tierStartsValues[currentIndex].length != tierStartsCategories[currentIndex].length*tierLevels[currentIndex])
                            tierStartsValues[currentIndex] = [];
                    }
                    
                    Answer = document.createElement("h4");
                    Answer.appendChild(document.createTextNode(subtitle));
                    DIV.appendChild(Answer);
                    
                    var number = 0;
                    for(var i = 0; i < categoryArray.length; ++i)
                    {
                        var ID = categoryArray[i].split(" ").join();
                        
                        if(ID != "" && ID != "Level:" && ID != "Rate:")
                        {
                            Answer = document.createElement("p");
                            Answer.appendChild(document.createTextNode(categoryArray[i]))
                            DIV.appendChild(Answer);
                        }
                        
                        for(var j = 0; j < tierLevels[currentIndex]; ++j)
                        {
                            Answer = document.createElement("label");
                            Answer.setAttribute("for", identifier + number);
                            Answer.appendChild(document.createTextNode("Tier " + (j + 1) + ": "));
                            DIV.appendChild(Answer);
                            
                            Answer = document.createElement("input");
                            Answer.setAttribute("type", "text");
                            Answer.id = identifier + number;
                            number++;
                            
                            if(j == 0 && identifier == "tierStarts")
                            {
                                Answer.value = 0;
                                Answer.readOnly = true;
                            }
                            
                            if(j == 1 && identifier == "tierStarts" &&  commodityStructure[currentIndex] == 'Budget')
                            {
                                Answer.value = 'indoor';
                                Answer.readOnly = true;
                            }
                            
                            DIV.appendChild(Answer);
                            
                            Answer = document.createElement("br");
                            DIV.appendChild(Answer);
                        }
                    }
                    
                    if(identifier == "tierStarts" && tierStartsValues[currentIndex] != null && tierStartsValues[currentIndex].length == tierStartsCategories[currentIndex].length*tierLevels[currentIndex])
                    {
                        var index = 0;
                        for(var i = 0; i < categoryArray.length; ++i)
                        {
                            for(var j = 0; j < tierLevels[currentIndex]; ++j)
                            {
                                var temp = document.getElementById(identifier + index);
                                temp.value = tierStartsValues[currentIndex][index];
                                index++;
                            }
                        }
                    }
                    else if(identifier == "tierPrices" && commodityCharges[currentIndex] != null && commodityCharges[currentIndex].length == commodityChargeCategories[currentIndex].length*tierLevels[currentIndex])
                    {
                        var index = 0;
                        for(var i = 0; i < categoryArray.length; ++i)
                        {
                            for(var j = 0; j < tierLevels[currentIndex]; ++j)
                            {
                                var temp = document.getElementById(identifier + index);
                                temp.value = commodityCharges[currentIndex][index];
                                index++;
                            }
                        }
                    }
                }
                
                function errorCheckCommodityParameters(structure, tierIdentifier, Continue)
                {
                    for(var i = 0; i < structure.length; ++i)
                    {
                        switch(structure[i])
                        {
                            case "Season":
                                if(season[currentIndex][tierIdentifier] == null || season[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Season");
                                } break;
                            case "SMeter Size":
                                if(commodityMeterSize[currentIndex][tierIdentifier] == null || commodityMeterSize[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Meter Size");
                                } break;
                            case "Month":
                                if(month[currentIndex][tierIdentifier] == null || month[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Month");
                                } break;
                            case "Temperature Zone":
                                if(temperatureZone[currentIndex][tierIdentifier] == null || temperatureZone[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Temperature Zone");
                                } break;
                            case "Elevation Zone":
                                if(elevationZone[currentIndex][tierIdentifier] == null || elevationZone[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Elevation Zone");
                                } break;
                            case "Pressure Zone":
                                if(pressureZone[currentIndex][tierIdentifier] == null || pressureZone[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                     alert("No parameters selected for Pressure Zone");
                                } break;
                            case "Lot Size Group":
                                if(lotSizeGroup[currentIndex][tierIdentifier] == null || lotSizeGroup[currentIndex][tierIdentifier].length == 0)
                                {
                                    Continue = false;
                                    alert("No parameters selected for Lot Size Group");
                                } break;
                        }
                    }
                    
                    
                    return Continue;
                }
                
                function createServiceChargeField()
                {
                    var serviceChargesDiv = document.getElementById("serviceChargesDiv")
                    
                    if(serviceChargesDiv.childNodes.length > 0)
                    {
                        clear(serviceChargesDiv);
                    }
                    
                    meterSizes[currentIndex] = [];
                    
                    for(var i = 0; i < survey.meterSizes.length; ++i)
                    {
                        var tempID = "meterSize" + i;
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox == null)
                        {
                            i = survey.meterSizes.length;
                        }
                        else if(checkCheckBox.checked == true)
                        {
                            meterSizes[currentIndex].push(survey.meterSizes[i]);
                        }
                    }
                    
                    meterTypes[currentIndex] = []
                    
                    for(var i = 0; i < survey.meterTypes.length; ++i)
                    {
                        var tempID = "meterType" + i;
                        
                        var checkCheckBox = document.getElementById(tempID);
                        
                        if(checkCheckBox == null)
                        {
                            i = survey.meterTypes.length;
                        }
                        else if(checkCheckBox.checked == true)
                        {
                            meterTypes[currentIndex].push(survey.meterTypes[i]);
                        }
                    }
                    
                    serviceChargeCategories[currentIndex] = [];
                    if(meterTypes[currentIndex].length > 0 && meterSizes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charges in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterTypes[currentIndex].length; ++i)
                        {
                            for(var j = 0; j < meterSizes[currentIndex].length; ++j)
                            {
                                var tempCategory = meterTypes[currentIndex][i] + '|' + meterSizes[currentIndex][j]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.setAttribute("style", "float: left; width: 150px;");
                                Answer.innerHTML = meterTypes[currentIndex][i] + ' ' + meterSizes[currentIndex][j] +'"';
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "charge" + (j + i * meterSizes[currentIndex].length);
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                        }
                    }
                    else if (meterSizes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charges in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterSizes[currentIndex].length; ++i)
                            {
                                var tempCategory = meterSizes[currentIndex][i]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.setAttribute("style", "float: left; width: 150px;");
                                Answer.innerHTML = meterSizes[currentIndex][i] + '"';
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.id = "charge" + i;
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                    }
                    else if (meterTypes[currentIndex].length > 0)
                    {
                        QuestionTxt("Enter the Service Charge(s) in the Field(s) Below:", 8, serviceChargesDiv);
                        for(var i = 0; i < meterTypes[currentIndex].length; ++i)
                            {
                                var tempCategory = meterTypes[currentIndex][i]
                                serviceChargeCategories[currentIndex].push(tempCategory);
                                
                                
                                Answer = document.createElement("label");
                                Answer.setAttribute("for", tempCategory);
                                Answer.setAttribute("style", "float: left; width: 150px; margin-bottom: 10px");
                                Answer.innerHTML = meterTypes[currentIndex][i];
                                serviceChargesDiv.appendChild(Answer);
                                
                                Answer = document.createElement("input");
                                Answer.setAttribute("type", "text");
                                Answer.setAttribute("style", "margin-bottom: 10px");
                                Answer.id = "charge" + i;
                                serviceChargesDiv.appendChild(Answer);
                                
                                var BREAK = document.createElement("br");
                                serviceChargesDiv.appendChild(BREAK);
                            }
                    }
                    
                    if(serviceCharges[currentIndex] != null && serviceCharges[currentIndex].length == serviceChargeCategories[currentIndex].length)
                    {
                        for(var i = 0; i < serviceChargeCategories[currentIndex].length; ++i)
                        {
                            var tempCharge = document.getElementById("charge" + i);
                            
                            tempCharge.value = serviceCharges[currentIndex][i];
                        }
                    }
                    else
                    {
                        serviceCharges[currentIndex] = [];
                    }
                }
                
                
                
                
                function PreviousGetAnswers()
                {
                    
                    if(currentIndex == 0)
                    {
                        MainPage();
                    }
                    else
                    {   
                        currentIndex -= 1;
                        RateStructure(currentIndex);
                    }
                }
                
                function NextGetAnswers()
                {
                    var Continue = true;
                    if(isServiceCharge[currentIndex])
                    {
                        if(serviceParameters[currentIndex] == null)
                        {
                            alert("You must select what the Service Charge Depends On");
                            Continue = false;
                        }
                        else
                        {
                            for(var i = 0; i < serviceParameters[currentIndex].length; ++i)
                            {
                                if(serviceParameters[currentIndex][i] == "Meter Size")
                                {
                                    if(meterSizes[currentIndex] == null)
                                    {
                                        alert("Select A Meter Size or Deselect The Meter Size Option");
                                        Continue = false;
                                    }
                                }
                                else if(serviceParameters[currentIndex][i] == "Meter Type")
                                {
                                    if(meterTypes[currentIndex] == null)
                                    {
                                        alert("Select A Meter Type or Deselect The Meter Type Option");
                                        Continue = false;
                                    }
                                }
                            }
                        }
                        if(Continue)
                        {
                            serviceCharges[currentIndex] = []
                            for(var i = 0; i < serviceChargeCategories[currentIndex].length; ++i)
                            {
                                var tempCharge = document.getElementById("charge" + i);
                        
                                if(tempCharge.value == "")
                                {
                                    alert("Service Charge at row " + (i + 1) + " isn't filled out");
                                    Continue = false;
                                }
                                else
                                {
                                    var regex = /^\d+(?:.\d{2})$/.test(tempCharge.value);
                                    if(regex)
                                    {
                                        serviceCharges[currentIndex].push(tempCharge.value);
                                    }
                                    else
                                    {
                                        alert("The service charge at row " + (i + 1) + " must be in the Format 1.00");
                                        Continue = false;
                                    } 
                                }
                            }
                            
                        }
                    }
                    if(isCommodityCharge[currentIndex])
                    {
                        if(commodityStructure[currentIndex] == null)
                        {
                            Continue = false;
                            alert('A commodity structure must be selected');
                        }
                        else
                        {
                            switch(commodityStructure[currentIndex])
                            {
                                case 'Uniform': 
                                commodityCharges[currentIndex] = []
                                if(isUniformDependsOn[currentIndex] == "No")
                                {
                                    var Charge = document.getElementById("uniformPrice0");
                                    if(Charge.value == "")
                                    { alert("You must enter a rate"); Continue = false; } 
                                    else
                                    { 
                                        var regex = /^\d+(?:.\d{2})$/.test(Charge.value);
                                        if(regex)
                                        {
                                            commodityCharges[currentIndex].push(Charge.value);
                                        }
                                        else
                                        {
                                            alert('Rate must be in the Format 1.00');
                                            Continue = false;
                                        }
                                    }
                                }
                                else
                                {
                                    if(uniformParameters[currentIndex] != null)
                                    {
                                        Continue = errorCheckCommodityParameters(uniformParameters[currentIndex], 0, Continue);
                                        
                                        if(Continue)
                                        {
                                            if(commodityChargeCategories[currentIndex] != null)
                                            {
                                                for(var i = 0; i < commodityChargeCategories[currentIndex].length; ++i)
                                                {
                                                    var tempCharge = document.getElementById("commodityCharge" + i);
                                    
                                                    if(tempCharge.value == "")
                                                    {
                                                        alert("Commodity Charge at row " + (i + 1) + " isn't filled out");
                                                        Continue = false;
                                                    }
                                                    else
                                                    {
                                                        var regex = /^\d+(?:.\d{2})$/.test(tempCharge.value);
                                                        if(regex)
                                                        {
                                                            commodityCharges[currentIndex].push(tempCharge.value);
                                                        }
                                                        else
                                                        {
                                                            alert("Commodity Charge at row " + (i + 1) + " must be in the Format 1.00");
                                                            Continue = false;
                                                        }
                                                    }
                                                }   
                                            }  
                                            else
                                            {
                                                Continue = false;
                                                alert("Please Select a Parameter");
                                            }
                                        }
                                    }
                                    else
                                    {
                                        Continue = false;
                                        alert('You must select a parameter for the flat rate or select "No" the rate does not depend on anything');
                                    }
                                }
                                break;
                                case 'Tiered': 
                                commodityCharges[currentIndex] = [];
                                tierStartsValues[currentIndex] = [];
                                
                                if(isTierStartsDepends[currentIndex])
                                {
                                    if(tierStartsParameters[currentIndex] != null && tierStartsParameters[currentIndex].length > 0)
                                    {
                                        Continue = errorCheckCommodityParameters(tierStartsParameters[currentIndex], 1, Continue);
                                        
                                        if(Continue)
                                        {
                                            if(tierStartsCategories[currentIndex] != null && tierStartsCategories[currentIndex].length > 0)
                                            {
                                                for(var i = 0; i < (tierStartsCategories[currentIndex].length*tierLevels[currentIndex]); ++i)
                                                {
                                                    var tempCharge = document.getElementById("tierStarts" + i);
                                    
                                                    if(tempCharge.value == "")
                                                    {
                                                        var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                        alert("The Tier Level for " + tierStartsCategories[currentIndex][tempIndex].replace(" Level:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " isn't filled out");
                                                        Continue = false;
                                                    }
                                                    else
                                                    {
                                                        var regex = /^\d+$/.test(tempCharge.value);
                                                        if(regex)
                                                        {
                                                            tierStartsValues[currentIndex].push(tempCharge.value);
                                                        }
                                                        else
                                                        {
                                                            var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                            alert("The Tier Level for " + tierStartsCategories[currentIndex][tempIndex].replace(" Level:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " must be an integer");
                                                            Continue = false;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                Continue = false;
                                                alert("Parameter Fields are empty");
                                            }
                                        }
                                    }
                                    else
                                    {
                                        Continue = false;
                                        alert("No parameters Selected for Tier Levels");
                                    }
                                }
                                else
                                {
                                    for(var i = 0; i < tierLevels[currentIndex]; ++i)
                                    {
                                        var Level = document.getElementById("tierStarts" + i);
                                        if(Level.value == "")
                                        { 
                                            alert("You must enter a CCF level for tier " + (i + 1)); 
                                            Continue = false;
                                        } 
                                        else
                                        { 
                                            var regex = /^\d+$/.test(Level.value);
                                            if(regex)
                                            {
                                                tierStartsValues[currentIndex].push(Level.value);
                                            }
                                            else
                                            {
                                                alert("The Tier Level for tier " + (i % tierLevels[currentIndex] + 1) + " must be an integer");
                                                Continue = false;
                                            } 
                                        }
                                    }
                                }
                                
                                if(isTierPricesDepends[currentIndex])
                                {
                                    if(tierPricesParameters[currentIndex] != null && tierPricesParameters[currentIndex].length > 0)
                                    {
                                        Continue = errorCheckCommodityParameters(tierPricesParameters[currentIndex], 2, Continue);
                                        
                                        if(Continue)
                                        {
                                            if(commodityChargeCategories[currentIndex] != null && commodityChargeCategories[currentIndex].length > 0)
                                            { 
                                                for(var i = 0; i < (commodityChargeCategories[currentIndex].length*tierLevels[currentIndex]); ++i)
                                                {
                                                    var tempCharge = document.getElementById("tierPrices" + i);
                                    
                                                    if(tempCharge.value == "")
                                                    {
                                                        var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                        alert("The Tier Price for " + commodityChargeCategories[currentIndex][tempIndex].replace(" Rate:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " isn't filled out");
                                                        Continue = false;
                                                    }
                                                    else
                                                    {
                                                        var regex = /^\d+(?:.\d{2})$/.test(tempCharge.value);
                                                        if(regex)
                                                        {
                                                            commodityCharges[currentIndex].push(tempCharge.value);
                                                        }
                                                        else
                                                        {
                                                            var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                            alert("The Tier Price for " + commodityChargeCategories[currentIndex][tempIndex].replace(" Rate:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " must be in the Format 1.00");
                                                            Continue = false;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                Continue = false;
                                                alert("Parameter Fields are empty");
                                            }
                                        }
                                    }
                                    else
                                    {
                                        Continue = false;
                                        alert("No parameters Selected for Tier Prices");
                                    }
                                }
                                else
                                {
                                    for(var i = 0; i < tierLevels[currentIndex]; ++i)
                                    {
                                        var Price = document.getElementById("tierPrices" + i);
                                        if(Price.value == "")
                                        { 
                                            alert("You must enter a Price for tier " + (i + 1)); 
                                            Continue = false;
                                        } 
                                        else
                                        { 
                                            var regex = /^\d+(?:.\d{2})$/.test(Price.value);
                                            if(regex)
                                            {
                                                commodityCharges[currentIndex].push(Price.value);
                                            }
                                            else
                                            {
                                                alert("The Tier Price for tier " + (i % tierLevels[currentIndex] + 1) + " must be in the Format 1.00");
                                                Continue = false;
                                            } 
                                        }
                                    }
                                }
                                
                                break;
                                case 'Budget':
                                gpcd[currentIndex] = null;
                                indoor[currentIndex] = null;
                                outdoor[currentIndex] = null;
                                commodityCharges[currentIndex] = [];
                                tierStartsValues[currentIndex] = [];
                                
                                gpcdValue = document.getElementById("gpcd");
                                if(gpcdValue.value != "")
                                    gpcd[currentIndex] = gpcdValue.value;
                                else
                                {
                                    alert("Gallons Per Capita Day field empty");
                                    Continue = false;
                                }
                                
                                indoorValue = document.getElementById("indoor");
                                if(indoorValue.value != "")
                                    indoor[currentIndex] = indoorValue.value;
                                else
                                {
                                    alert("Indoor Equation field empty");
                                    Continue = false;
                                }
                                
                                outdoorValue = document.getElementById("outdoor");
                                if(indoorValue.value != "")
                                    outdoor[currentIndex] = outdoorValue.value;
                                else
                                {
                                    alert("Outdoor Equation field empty");
                                    Continue = false;
                                }
                                
                                if(isTierStartsDepends[currentIndex])
                                {
                                    if(tierStartsParameters[currentIndex] != null && tierStartsParameters[currentIndex].length > 0)
                                    {
                                        Continue = errorCheckCommodityParameters(tierStartsParameters[currentIndex], 1, Continue);
                                        
                                        if(Continue)
                                        {
                                            if(tierStartsCategories[currentIndex] != null && tierStartsCategories[currentIndex].length > 0)
                                            {
                                                for(var i = 0; i < (tierStartsCategories[currentIndex].length*tierLevels[currentIndex]); ++i)
                                                {
                                                    var tempCharge = document.getElementById("tierStarts" + i);
                                    
                                                    if(tempCharge.value == "")
                                                    {
                                                        var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                        alert("The Tier Level for " + tierStartsCategories[currentIndex][tempIndex].replace(" Level:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " isn't filled out");
                                                        Continue = false;
                                                    }
                                                    else
                                                    {
                                                        if(i % tierLevels[currentIndex] + 1 > 2)
                                                        {
                                                            var regex = /^\d+(?:%)$/.test(tempCharge.value);
                                                            if(regex)
                                                            {
                                                                tierStartsValues[currentIndex].push(tempCharge.value);
                                                            }
                                                            else
                                                            {
                                                                var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                                alert("The Tier Level for " + tierStartsCategories[currentIndex][tempIndex].replace(" Level:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " must be in the format 100% or 1%");
                                                                Continue = false;
                                                            }
                                                        }
                                                        else
                                                        {
                                                            tierStartsValues[currentIndex].push(tempCharge.value);
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                Continue = false;
                                                alert("Parameter Fields are empty");
                                            }
                                        }
                                    }
                                    else
                                    {
                                        Continue = false;
                                        alert("No parameters Selected for Tier Levels");
                                    }
                                }
                                else
                                {
                                    for(var i = 0; i < tierLevels[currentIndex]; ++i)
                                    {
                                        var Level = document.getElementById("tierStarts" + i);
                                        if(Level.value == "")
                                        { 
                                            alert("You must enter a CCF level for tier " + (i + 1)); 
                                            Continue = false;
                                        } 
                                        else
                                        { 
                                            if(i > 1)
                                            {
                                                var regex = /^\d+(?:%)$/.test(Level.value);
                                                if(regex)
                                                {
                                                    tierStartsValues[currentIndex].push(Level.value);
                                                }
                                                else
                                                {
                                                    alert("The Tier Level for tier " + (i % tierLevels[currentIndex] + 1) + " must be in the format 100% or 1%");
                                                    Continue = false;
                                                }
                                            }
                                            else
                                               tierStartsValues[currentIndex].push(Level.value); 
                                        }
                                    }
                                }
                                
                                if(isTierPricesDepends[currentIndex])
                                {
                                    if(tierPricesParameters[currentIndex] != null && tierPricesParameters[currentIndex].length > 0)
                                    {
                                        Continue = errorCheckCommodityParameters(tierPricesParameters[currentIndex], 2, Continue);
                                        
                                        if(Continue)
                                        {
                                            if(commodityChargeCategories[currentIndex] != null && commodityChargeCategories[currentIndex].length > 0)
                                            { 
                                                for(var i = 0; i < (commodityChargeCategories[currentIndex].length*tierLevels[currentIndex]); ++i)
                                                {
                                                    var tempCharge = document.getElementById("tierPrices" + i);
                                    
                                                    if(tempCharge.value == "")
                                                    {
                                                        var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                        alert("The Tier Price for " + commodityChargeCategories[currentIndex][tempIndex].replace(" Rate:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " isn't filled out");
                                                        Continue = false;
                                                    }
                                                    else
                                                    {
                                                        var regex = /^\d+(?:.\d{2})$/.test(tempCharge.value);
                                                        if(regex)
                                                        {
                                                            commodityCharges[currentIndex].push(tempCharge.value);
                                                        }
                                                        else
                                                        {
                                                            var tempIndex = Math.floor(i/tierLevels[currentIndex]);
                                                            alert("The Tier Price for " + commodityChargeCategories[currentIndex][tempIndex].replace(" Rate:", "") + " at tier " + (i % tierLevels[currentIndex] + 1) + " must be in the Format 1.00");
                                                            Continue = false;
                                                        }
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                Continue = false;
                                                alert("Parameter Fields are empty");
                                            }
                                        }
                                    }
                                    else
                                    {
                                        Continue = false;
                                        alert("No parameters Selected for Tier Prices");
                                    }
                                }
                                else
                                {
                                    for(var i = 0; i < tierLevels[currentIndex]; ++i)
                                    {
                                        var Price = document.getElementById("tierPrices" + i);
                                        if(Price.value == "")
                                        { 
                                            alert("You must enter a Price for tier " + (i + 1)); 
                                            Continue = false;
                                        } 
                                        else
                                        { 
                                            var regex = /^\d+(?:.\d{2})$/.test(Price.value);
                                            if(regex)
                                            {
                                                commodityCharges[currentIndex].push(Price.value);
                                            }
                                            else
                                            {
                                                alert("The Tier Price for tier " + (i % tierLevels[currentIndex] + 1) + " must be in the Format 1.00");
                                                Continue = false;
                                            } 
                                        }
                                    }
                                }                                
                                break;
                            }
                        }
                    }
                    
                    if(Continue)
                    {
                        if(currentIndex == SelectedRateStructures.length - 1)
                        {
                            Complete();
                        }
                        else
                        {
                            currentIndex += 1;
                            RateStructure(currentIndex);
                        }
                    }
                }
                
                function parameterParser(structure)
                {
                    switch(structure)
                    {
                        case 'Season': return 'season'; break;
                        case 'Temperature Zone': return 'temperature_zone'; break;
                        case 'Elevation Zone': return 'elevation_zone'; break;
                        case 'Pressure Zone': return 'pressure_zone'; break;
                        case 'Lot Size Group': return 'lot_size_group'; break;
                        case 'Meter Size': return 'meter_size'; break;
                        case 'Month': return 'month'; break;
                    }
                }
                
                function Complete()
                {
                    var OWRSformat = {
                       "metadata" : {
                            "effective_date" : "" + EffectiveDate + "",
                            "utility_name" : "" + UtilityName + "",
                            "bill_frequency" : "" + BillFrequency + ""
                       }, 
                       "rate_structure" : {
                       
                       }
                    };
                    
                    for(var structure in SelectedRateStructures)
                    {
                        var tempStructure; 
                        
                        var serviceJSON;
                        var commodityJSON;
                        
                        if(isServiceCharge[structure])
                        {
                            serviceJSON = {
                                "depends_on" : [],
                                "values" : {}
                            };
                            
                            for(var parameter in serviceParameters[structure])
                            {
                                if(serviceParameters[structure][parameter] == "Meter Size")
                                {
                                    serviceJSON.depends_on.push("meter_size");
                                }
                                else if(serviceParameters[structure][parameter] == "Meter Type")
                                {
                                    serviceJSON.depends_on.push("meter_type");
                                }
                            }
                            
                            var valueStorage = '{';
                            for(var value in serviceCharges[structure])
                            {
                                if(value == serviceCharges[structure].length - 1)
                                {
                                    valueStorage += '"' + serviceChargeCategories[structure][value] + '" : ' + serviceCharges[structure][value] + ' }'
                                }
                                else
                                {
                                    valueStorage += '"' + serviceChargeCategories[structure][value] + '" : ' + serviceCharges[structure][value] + ', '
                                }
                            }
                            serviceJSON.values = JSON.parse(valueStorage);
                        }
                        else
                        { serviceJSON = 0; }
                    
                        if(isCommodityCharge[structure])
                        {
                            commodityJSON = "";
                            switch(commodityStructure[structure])
                            {
                                case 'Uniform':
                                    commodityJSON  = {
                                        "commodity_charge": "flat_rate*usage_ccf",
                                        "flat_rate" : {}
                                    };
                                    
                                    if(isUniformDependsOn[structure] == 'No')
                                    {
                                        commodityJSON.flat_rate = Number(commodityCharges[structure][0]);
                                    }
                                    else
                                    {
                                        commodityJSON.flat_rate.depends_on = [];
                                        
                                        for(var i = 0; i < uniformParameters[structure].length; ++i)
                                        {
                                            var temp = parameterParser(uniformParameters[structure][i]);
                                            commodityJSON.flat_rate.depends_on.push(temp);
                                        }
                                        
                                        var tempComm = "{ "
                                        for(value in commodityChargeCategories[structure])
                                        {
                                            var replacementStr = commodityChargeCategories[structure][value].replace(" Rate:", "");
                                            replacementStr = replacementStr.replace("Pressure ", ""); replacementStr = replacementStr.replace("Elevation ", "");
                                            replacementStr = replacementStr.replace("Lot Size ", ""); replacementStr = replacementStr.replace('"', '');
                                            for(var i = 0; i < survey.month.length; ++i)
                                            {
                                                replacementStr = replacementStr.replace(survey.month[i], i + 1);
                                            }
                                            
                                            if(value == commodityChargeCategories[structure].length - 1)
                                            {
                                                tempComm += '"' + replacementStr.split(" ").join("|") + '": ' + commodityCharges[structure][value]+ ' }';
                                            }
                                            else
                                            {
                                                tempComm += '"' + replacementStr.split(" ").join("|") + '": ' + commodityCharges[structure][value]+ ', ';
                                            }
                                        }
                                        commodityJSON.flat_rate.values = JSON.parse(tempComm);
                                    } break;
                                case 'Tiered':
                                    commodityJSON = { "commodity_charge": "Tiered" };
                                    if(isTierStartsDepends[structure])
                                    {
                                        commodityJSON.tier_starts = { "depends_on": [],
                                                                      "values": {}     };
                                        for(var i = 0; i < tierStartsParameters[structure].length; ++i)
                                        {
                                            var temp = parameterParser(tierStartsParameters[structure][i])
                                            commodityJSON.tier_starts.depends_on.push(temp);
                                        }
                                        
                                        var tempComm = "{ ", number = 0; 
                                        for(value in tierStartsCategories[structure])
                                        {
                                            var replacementStr = tierStartsCategories[structure][value].replace(" Level:", "");
                                            replacementStr = replacementStr.replace("Pressure ", ""); replacementStr = replacementStr.replace("Elevation ", "");
                                            replacementStr = replacementStr.replace("Lot Size ", ""); replacementStr = replacementStr.replace('"', '');
                                            for(var i = 0; i < survey.month.length; ++i)
                                            {
                                                replacementStr = replacementStr.replace(survey.month[i], i + 1);
                                            }
                                            
                                            tempComm += ' "' + replacementStr.split(" ").join("|") + '": [ ';
                                            
                                            for(var k = 0; k < tierLevels[structure]; ++k)
                                            {
                                                if(k == tierLevels[structure] - 1)
                                                {
                                                    tempComm += tierStartsValues[structure][number] + ' ]';
                                                }
                                                else
                                                {
                                                    tempComm += tierStartsValues[structure][number] + ', ';
                                                }
                                                number++;
                                            }
                                            
                                            if(value == tierStartsCategories[structure].length - 1)
                                                tempComm += ' }';
                                            else
                                                tempComm += ', '
                                        }
                                        commodityJSON.tier_starts.values = JSON.parse(tempComm)
                                    }
                                    else
                                    {
                                        commodityJSON.tier_starts = [];
                                        for(var i = 0; i < tierLevels[structure]; ++i)
                                        {
                                            commodityJSON.tier_starts.push(Number(tierStartsValues[structure][i]));
                                        }
                                    }
                                    if(isTierPricesDepends[structure])
                                    {
                                        commodityJSON.tier_prices = { "depends_on": [],
                                                                      "values": {}     };
                                        for(var i = 0; i < tierPricesParameters[structure].length; ++i)
                                        {
                                            var temp = parameterParser(tierPricesParameters[structure][i])
                                            commodityJSON.tier_prices.depends_on.push(temp);
                                        }
                                        
                                        var tempComm = "{ ", number = 0; 
                                        for(value in commodityChargeCategories[structure])
                                        {
                                            var replacementStr = commodityChargeCategories[structure][value].replace(" Rate:", "");
                                            replacementStr = replacementStr.replace("Pressure ", ""); replacementStr = replacementStr.replace("Elevation ", "");
                                            replacementStr = replacementStr.replace("Lot Size ", ""); replacementStr = replacementStr.replace('"', '');
                                            for(var i = 0; i < survey.month.length; ++i)
                                            {
                                                replacementStr = replacementStr.replace(survey.month[i], i + 1);
                                            }
                                            
                                            tempComm += ' "' + replacementStr.split(" ").join("|") + '": [ ';
                                            
                                            for(var k = 0; k < tierLevels[structure]; ++k)
                                            {
                                                if(k == tierLevels[structure] - 1)
                                                {
                                                    tempComm += commodityCharges[structure][number] + ' ]';
                                                }
                                                else
                                                {
                                                    tempComm += commodityCharges[structure][number] + ', ';
                                                }
                                                number++;
                                            }
                                            
                                            if(value == commodityChargeCategories[structure].length - 1)
                                                tempComm += ' }';
                                            else
                                                tempComm += ', '
                                        }
                                        commodityJSON.tier_prices.values = JSON.parse(tempComm)
                                    }
                                    else
                                    {
                                        commodityJSON.tier_prices = [];
                                        for(var i = 0; i < tierLevels[structure]; ++i)
                                        {
                                            commodityJSON.tier_prices.push(Number(commodityCharges[structure][i]));
                                        }
                                    } break;
                                case 'Budget':
                                commodityJSON = { "commodity_charge": "Budget" };
                                    
                                    commodityJSON.gpcd = gpcd[structure];
                                    commodityJSON.indoor = indoor[structure];
                                    commodityJSON.outdoor = outdoor[structure];
                                    commodityJSON.budget = "indoor + outdoor";
                                    
                                    if(isTierStartsDepends[structure])
                                    {
                                        commodityJSON.tier_starts = { "depends_on": [],
                                                                      "values": {}     };
                                        for(var i = 0; i < tierStartsParameters[structure].length; ++i)
                                        {
                                            var temp = parameterParser(tierStartsParameters[structure][i])
                                            commodityJSON.tier_starts.depends_on.push(temp);
                                        }
                                        
                                        var tempComm = "{ ", number = 0; 
                                        for(value in tierStartsCategories[structure])
                                        {
                                            var replacementStr = tierStartsCategories[structure][value].replace(" Level:", "");
                                            replacementStr = replacementStr.replace("Pressure ", ""); replacementStr = replacementStr.replace("Elevation ", "");
                                            replacementStr = replacementStr.replace("Lot Size ", ""); replacementStr = replacementStr.replace('"', '');
                                            for(var i = 0; i < survey.month.length; ++i)
                                            {
                                                replacementStr = replacementStr.replace(survey.month[i], i + 1);
                                            }
                                            
                                            tempComm += ' "' + replacementStr.split(" ").join("|") + '": [ ';
                                            
                                            for(var k = 0; k < tierLevels[structure]; ++k)
                                            {
                                                if(k == tierLevels[structure] - 1)
                                                {
                                                    tempComm += '"' + tierStartsValues[structure][number] + '" ]';
                                                }
                                                else
                                                {
                                                    tempComm += '"' + tierStartsValues[structure][number] + '", ';
                                                }
                                                number++;
                                            }
                                            
                                            if(value == tierStartsCategories[structure].length - 1)
                                                tempComm += ' }';
                                            else
                                                tempComm += ', '
                                        }
                                        commodityJSON.tier_starts.values = JSON.parse(tempComm)
                                    }
                                    else
                                    {
                                        commodityJSON.tier_starts = [];
                                        for(var i = 0; i < tierLevels[structure]; ++i)
                                        {
                                            commodityJSON.tier_starts.push(tierStartsValues[structure][i]);
                                        }
                                    }
                                    if(isTierPricesDepends[structure])
                                    {
                                        commodityJSON.tier_prices = { "depends_on": [],
                                                                      "values": {}     };
                                        for(var i = 0; i < tierPricesParameters[structure].length; ++i)
                                        {
                                            var temp = parameterParser(tierPricesParameters[structure][i])
                                            commodityJSON.tier_prices.depends_on.push(temp);
                                        }
                                        
                                        var tempComm = "{ ", number = 0; 
                                        for(value in commodityChargeCategories[structure])
                                        {
                                            var replacementStr = commodityChargeCategories[structure][value].replace(" Rate:", "");
                                            replacementStr = replacementStr.replace("Pressure ", ""); replacementStr = replacementStr.replace("Elevation ", "");
                                            replacementStr = replacementStr.replace("Lot Size ", ""); replacementStr = replacementStr.replace('"', '');
                                            for(var i = 0; i < survey.month.length; ++i)
                                            {
                                                replacementStr = replacementStr.replace(survey.month[i], i + 1);
                                            }
                                            
                                            tempComm += ' "' + replacementStr.split(" ").join("|") + '": [ ';
                                            
                                            for(var k = 0; k < tierLevels[structure]; ++k)
                                            {
                                                if(k == tierLevels[structure] - 1)
                                                {
                                                    tempComm += commodityCharges[structure][number] + ' ]';
                                                }
                                                else
                                                {
                                                    tempComm += commodityCharges[structure][number] + ', ';
                                                }
                                                number++;
                                            }
                                            
                                            if(value == commodityChargeCategories[structure].length - 1)
                                                tempComm += ' }';
                                            else
                                                tempComm += ', '
                                        }
                                        commodityJSON.tier_prices.values = JSON.parse(tempComm)
                                    }
                                    else
                                    {
                                        commodityJSON.tier_prices = [];
                                        for(var i = 0; i < tierLevels[structure]; ++i)
                                        {
                                            commodityJSON.tier_prices.push(Number(commodityCharges[structure][i]));
                                        }
                                    } break;
                            }
                        }
                        else
                        { commodityJSON = { "commodity_charge" : 0 } };
                        
                        switch(SelectedRateStructures[structure])
                        {
                            case "Residential Single": tempStructure = { "RESIDENTIAL_SINGLE" : { "service_charge" : {} } };
                                                        tempStructure.RESIDENTIAL_SINGLE.service_charge = serviceJSON ;
                                                        tempStructure.RESIDENTIAL_SINGLE = jQuery.extend({}, tempStructure.RESIDENTIAL_SINGLE, commodityJSON); 
                                                        tempStructure.RESIDENTIAL_SINGLE.bill = "service_charge+commodity_charge"; break;
                            case "Residential Multi": tempStructure = { "RESIDENTIAL_MULTI" : { "service_charge" : {} } }; 
                                                        tempStructure.RESIDENTIAL_MULTI.service_charge = serviceJSON; 
                                                        tempStructure.RESIDENTIAL_MULTI = jQuery.extend({}, tempStructure.RESIDENTIAL_MULTI, commodityJSON); 
                                                        tempStructure.RESIDENTIAL_MULTI.bill = "service_charge+commodity_charge"; break;
                            case "Irrigation": tempStructure = { "IRRIGATION" : { "service_charge" : {} } };
                                                        tempStructure.IRRIGATION.service_charge = serviceJSON; 
                                                        tempStructure.IRRIGATION = jQuery.extend({}, tempStructure.IRRIGATION, commodityJSON); 
                                                        tempStructure.IRRIGATION.bill = "service_charge+commodity_charge"; break;
                            case "Commercial": tempStructure = { "COMMERCIAL" : { "service_charge" : {} } }; 
                                                        tempStructure.COMMERCIAL.service_charge = serviceJSON; 
                                                        tempStructure.COMMERCIAL = jQuery.extend({}, tempStructure.COMMERCIAL, commodityJSON); 
                                                        tempStructure.COMMERCIAL.bill = "service_charge+commodity_charge"; break;
                            case "Industrial": tempStructure = { "INDUSTRIAL" : { "service_charge" : {} } };
                                                        tempStructure.INDUSTRIAL.service_charge = serviceJSON; 
                                                        tempStructure.INDUSTRIAL = jQuery.extend({}, tempStructure.INDUSTRIAL, commodityJSON); 
                                                        tempStructure.INDUSTRIAL.bill = "service_charge+commodity_charge"; break;
                            case "Institutional": tempStructure = { "INSTITUTIONAL" : { "service_charge" : {} } };
                                                        tempStructure.INSTITUTIONAL.service_charge = serviceJSON; 
                                                        tempStructure.INSTITUTIONAL = jQuery.extend({}, tempStructure.INSTITUTIONAL, commodityJSON); 
                                                        tempStructure.INSTITUTIONAL.bill = "service_charge+commodity_charge"; break;
                            case "Fire Service": tempStructure = { "FIRE_SERVICE" : { "service_charge" : {} } }; 
                                                        tempStructure.FIRE_SERVICE.service_charge = serviceJSON; 
                                                        tempStructure.RFIRE_SERVICE = jQuery.extend({}, tempStructure.FIRE_SERVICE, commodityJSON); 
                                                        tempStructure.RFIRE_SERVICE.bill = "service_charge+commodity_charge"; break;
                            case "Non-Potable": tempStructure = { "NONPOTABLE" : { "service_charge" : {} } };
                                                        tempStructure.NONPOTABLE.service_charge = serviceJSON; 
                                                        tempStructure.NONPOTABLE = jQuery.extend({}, tempStructure.NONPOTABLE, commodityJSON); 
                                                        tempStructure.NONPOTABLE.bill = "service_charge+commodity_charge"; break;
                            case "Non-Residential": tempStructure = { "NON_RESIDENTIAL" : { "service_charge" : {} } }; 
                                                        tempStructure.NON_RESIDENTIAL.service_charge = serviceJSON; 
                                                        tempStructure.NON_RESIDENTIAL = jQuery.extend({}, tempStructure.NON_RESIDENTIAL, commodityJSON); 
                                                        tempStructure.NON_RESIDENTIAL.bill = "service_charge+commodity_charge"; break;
                            case "Unmetered": tempStructure = { "UNMETERED" : { "service_charge" : {} } };
                                                        tempStructure.UNMETERED.service_charge = serviceJSON; 
                                                        tempStructure.UNMETERED = jQuery.extend({}, tempStructure.UNMETERED, commodityJSON); 
                                                        tempStructure.UNMETERED.bill = "service_charge+commodity_charge"; break;
                            case "Reclaimed": tempStructure = { "RECLAIMED" : { "service_charge" : {} } }; 
                                                        tempStructure.RECLAIMED.service_charge = serviceJSON; 
                                                        tempStructure.RECLAIMED = jQuery.extend({}, tempStructure.RECLAIMED, commodityJSON); 
                                                        tempStructure.RECLAIMED.bill = "service_charge+commodity_charge"; break;
                            case "Governmental": tempStructure = { "GOVERNMENTAL" : { "service_charge" : {} } }; 
                                                        tempStructure.GOVERNMENTAL.service_charge = serviceJSON; 
                                                        tempStructure.GOVERNMENTAL = jQuery.extend({}, tempStructure.GOVERNMENTAL, commodityJSON); 
                                                        tempStructure.GOVERNMENTAL.bill = "service_charge+commodity_charge"; break;
                            case "Interruptible": tempStructure = { "INTERRUPTIBLE" : { "service_charge" : {} } }; 
                                                        tempStructure.INTERRUPTIBLE.service_charge = serviceJSON; 
                                                        tempStructure.INTERRUPTIBLE = jQuery.extend({}, tempStructure.INTERRUPTIBLE, commodityJSON); 
                                                        tempStructure.INTERRUPTIBLE.bill = "service_charge+commodity_charge"; break;
                            case "Docks Shipping": tempStructure = { "DOCKS_SHIPPING" : { "service_charge" : {} } }; 
                                                        tempStructure.DOCKS_SHIPPING.service_charge = serviceJSON; 
                                                        tempStructure.DOCKS_SHIPPING = jQuery.extend({}, tempStructure.DOCKS_SHIPPING, commodityJSON); 
                                                        tempStructure.DOCKS_SHIPPING.bill = "service_charge+commodity_charge"; break;
                            case "Building Contractor": tempStructure = { "BUILDING_CONTRACTOR" : { "service_charge" : {} } }; 
                                                        tempStructure.BUILDING_CONTRACTOR.service_charge = serviceJSON; 
                                                        tempStructure.BUILDING_CONTRACTOR = jQuery.extend({}, tempStructure.BUILDING_CONTRACTOR, commodityJSON); 
                                                        tempStructure.BUILDING_CONTRACTOR.bill = "service_charge+commodity_charge"; break;
                            case "Residential Construction": tempStructure = { "RESIDENTIAL_CONSTRUCTION" : { "service_charge" : {} } }; 
                                                        tempStructure.RESIDENTIAL_CONSTRUCTION.service_charge = serviceJSON; 
                                                        tempStructure.RESIDENTIAL_CONSTRUCTION = jQuery.extend({}, tempStructure.RESIDENTIAL_CONSTRUCTION, commodityJSON);
                                                        tempStructure.RESIDENTIAL_CONSTRUCTION.bill = "service_charge+commodity_charge"; break;
                            case "Other": tempStructure = { "OTHER" : { "service_charge" : {} } }; 
                                                        tempStructure.OTHER.service_charge = serviceJSON; 
                                                        tempStructure.OTHER = jQuery.extend({}, tempStructure.OTHER, commodityJSON); 
                                                        tempStructure.OTHER.bill = "service_charge+commodity_charge"; break;
                        }
                        OWRSformat.rate_structure = jQuery.extend({}, OWRSformat.rate_structure, tempStructure);
                    }
                    
                    var YAML = jsyaml.safeDump(OWRSformat);
                    
                    var cleared = document.getElementById("surveyContainer");
                    clear(cleared);
                    
                    var TheEnd = document.createElement("h1");
                    TheEnd.appendChild(document.createTextNode("Thank You"));
                    cleared.appendChild(TheEnd);
                    
                    alert(YAML);
                }
                
                
                function QuestionTxt(question, number, Parent)
                {
                    Question = document.createElement("p");
                    Question.appendChild(document.createTextNode(question));
                    Question.setAttribute("id", "question" + number);
                    Parent.appendChild(Question);
                }
                
                function clear(parent)
                {
                    while(parent.firstChild)
                    {  parent.removeChild(parent.firstChild); }
                }
                
                MainPage();